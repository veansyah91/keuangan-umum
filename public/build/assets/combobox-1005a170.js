import{r as p,b as ze,R as N}from"./app-f3916a1a.js";import{s as Ie,b as L,o as g,O as fe,U as H,u as q,p as ae,g as Pe,e as te,x as $e,C as J,y as Y,d as Fe,c as he}from"./transition-a6db7282.js";import{a as De,I as G,o as _,r as Ae}from"./keyboard-94fa1eb3.js";import{c as _e,u as ke,a as Le,n as Ne,m as me,t as ve,d as Ve,I as je}from"./active-element-history-89d47ca5.js";import{T as Be}from"./use-resolve-button-type-b9a318bd.js";function X(t,i,e){let n=e.initialDeps??[],o;return()=>{var r,l,a,c;let u;e.key&&((r=e.debug)!=null&&r.call(e))&&(u=Date.now());const f=t();if(!(f.length!==n.length||f.some((s,h)=>n[h]!==s)))return o;n=f;let C;if(e.key&&((l=e.debug)!=null&&l.call(e))&&(C=Date.now()),o=i(...f),e.key&&((a=e.debug)!=null&&a.call(e))){const s=Math.round((Date.now()-u)*100)/100,h=Math.round((Date.now()-C)*100)/100,O=h/16,x=(v,M)=>{for(v=String(v);v.length<M;)v=" "+v;return v};console.info(`%c⏱ ${x(h,5)} /${x(s,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*O,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(c=e==null?void 0:e.onChange)==null||c.call(e,o),o}}function le(t,i){if(t===void 0)throw new Error(`Unexpected undefined${i?`: ${i}`:""}`);return t}const Ke=(t,i)=>Math.abs(t-i)<1,Ue=(t,i)=>{let e;return function(...n){clearTimeout(e),e=setTimeout(()=>t.apply(this,n),i)}},qe=t=>t,He=t=>{const i=Math.max(t.startIndex-t.overscan,0),e=Math.min(t.endIndex+t.overscan,t.count-1),n=[];for(let o=i;o<=e;o++)n.push(o);return n},Je=(t,i)=>{const e=t.scrollElement;if(!e)return;const n=r=>{const{width:l,height:a}=r;i({width:Math.round(l),height:Math.round(a)})};if(n(e.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const o=new ResizeObserver(r=>{const l=r[0];if(l!=null&&l.borderBoxSize){const a=l.borderBoxSize[0];if(a){n({width:a.inlineSize,height:a.blockSize});return}}n(e.getBoundingClientRect())});return o.observe(e,{box:"border-box"}),()=>{o.unobserve(e)}},be={passive:!0},We=typeof window>"u"?!0:"onscrollend"in window,Xe=(t,i)=>{const e=t.scrollElement;if(!e)return;let n=0;const o=We?()=>{}:Ue(()=>{i(n,!1)},t.options.isScrollingResetDelay),r=c=>()=>{n=e[t.options.horizontal?"scrollLeft":"scrollTop"],o(),i(n,c)},l=r(!0),a=r(!1);return a(),e.addEventListener("scroll",l,be),e.addEventListener("scrollend",a,be),()=>{e.removeEventListener("scroll",l),e.removeEventListener("scrollend",a)}},Ye=(t,i,e)=>{if(i!=null&&i.borderBoxSize){const n=i.borderBoxSize[0];if(n)return Math.round(n[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(t.getBoundingClientRect()[e.options.horizontal?"width":"height"])},Ge=(t,{adjustments:i=0,behavior:e},n)=>{var o,r;const l=t+i;(r=(o=n.scrollElement)==null?void 0:o.scrollTo)==null||r.call(o,{[n.options.horizontal?"left":"top"]:l,behavior:e})};class Qe{constructor(i){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const n=()=>e||(typeof ResizeObserver<"u"?e=new ResizeObserver(o=>{o.forEach(r=>{this._measureElement(r.target,r)})}):null);return{disconnect:()=>{var o;return(o=n())==null?void 0:o.disconnect()},observe:o=>{var r;return(r=n())==null?void 0:r.observe(o,{box:"border-box"})},unobserve:o=>{var r;return(r=n())==null?void 0:r.unobserve(o)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([n,o])=>{typeof o>"u"&&delete e[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:qe,rangeExtractor:He,onChange:()=>{},measureElement:Ye,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,...e}},this.notify=(e,n)=>{var o,r;const{startIndex:l,endIndex:a}=this.range??{startIndex:void 0,endIndex:void 0},c=this.calculateRange();(e||l!==(c==null?void 0:c.startIndex)||a!==(c==null?void 0:c.endIndex))&&((r=(o=this.options).onChange)==null||r.call(o,this,n))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const e=this.options.getScrollElement();this.scrollElement!==e&&(this.cleanup(),this.scrollElement=e,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,n=>{this.scrollRect=n,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(n,o)=>{this.scrollAdjustments=0,this.scrollDirection=o?this.scrollOffset<n?"forward":"backward":null,this.scrollOffset=n;const r=this.isScrolling;this.isScrolling=o,this.notify(r!==o,o)})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurementOptions=X(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,n,o,r)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:n,scrollMargin:o,getItemKey:r}),{key:!1}),this.getFurthestMeasurement=(e,n)=>{const o=new Map,r=new Map;for(let l=n-1;l>=0;l--){const a=e[l];if(o.has(a.lane))continue;const c=r.get(a.lane);if(c==null||a.end>c.end?r.set(a.lane,a):a.end<c.end&&o.set(a.lane,!0),o.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort((l,a)=>l.end===a.end?l.index-a.index:l.end-a.end)[0]:void 0},this.getMeasurements=X(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:n,scrollMargin:o,getItemKey:r},l)=>{const a=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,a);for(let u=a;u<e;u++){const f=r(u),b=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),C=b?b.end+this.options.gap:n+o,s=l.get(f),h=typeof s=="number"?s:this.options.estimateSize(u),O=C+h,x=b?b.lane:u%this.options.lanes;c[u]={index:u,start:C,size:h,end:O,key:f,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=X(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,n,o)=>this.range=e.length>0&&n>0?Ze({measurements:e,outerSize:n,scrollOffset:o}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=X(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,n,o,r)=>n===null?[]:e({startIndex:n.startIndex,endIndex:n.endIndex,overscan:o,count:r}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const n=this.options.indexAttribute,o=e.getAttribute(n);return o?parseInt(o,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(e,n)=>{const o=this.measurementsCache[this.indexFromElement(e)];if(!o||!e.isConnected){this.measureElementCache.forEach((a,c)=>{a===e&&(this.observer.unobserve(e),this.measureElementCache.delete(c))});return}const r=this.measureElementCache.get(o.key);r!==e&&(r&&this.observer.unobserve(r),this.observer.observe(e),this.measureElementCache.set(o.key,e));const l=this.options.measureElement(e,n,this);this.resizeItem(o,l)},this.resizeItem=(e,n)=>{const o=this.itemSizeCache.get(e.key)??e.size,r=n-o;r!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(e,r,this):e.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=r,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,n)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=X(()=>[this.getIndexes(),this.getMeasurements()],(e,n)=>{const o=[];for(let r=0,l=e.length;r<l;r++){const a=e[r],c=n[a];o.push(c)}return o},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const n=this.getMeasurements();return le(n[Oe(0,n.length-1,o=>le(n[o]).start,e)])},this.getOffsetForAlignment=(e,n)=>{const o=this.getSize();n==="auto"&&(e<=this.scrollOffset?n="start":e>=this.scrollOffset+o?n="end":n="start"),n==="start"?e=e:n==="end"?e=e-o:n==="center"&&(e=e-o/2);const r=this.options.horizontal?"scrollWidth":"scrollHeight",a=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[r]:this.scrollElement[r]:0)-this.getSize();return Math.max(Math.min(a,e),0)},this.getOffsetForIndex=(e,n="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const o=le(this.getMeasurements()[e]);if(n==="auto")if(o.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)n="end";else if(o.start<=this.scrollOffset+this.options.scrollPaddingStart)n="start";else return[this.scrollOffset,n];const r=n==="end"?o.end+this.options.scrollPaddingEnd:o.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(r,n),n]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:n="start",behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,n),{adjustments:void 0,behavior:o})},this.scrollToIndex=(e,{align:n="auto",behavior:o}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[r,l]=this.getOffsetForIndex(e,n);this._scrollToOffset(r,{adjustments:void 0,behavior:o}),o!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[c]=this.getOffsetForIndex(e,l);Ke(c,this.scrollOffset)||this.scrollToIndex(e,{align:l,behavior:o})}else this.scrollToIndex(e,{align:l,behavior:o})}))},this.scrollBy=(e,{behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var e;const n=this.getMeasurements();let o;return n.length===0?o=this.options.paddingStart:o=this.options.lanes===1?((e=n[n.length-1])==null?void 0:e.end)??0:Math.max(...n.slice(-this.options.lanes).map(r=>r.end)),o-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:n,behavior:o})=>{this.options.scrollToFn(e,{behavior:o,adjustments:n},this)},this.measure=()=>{var e,n;this.itemSizeCache=new Map,(n=(e=this.options).onChange)==null||n.call(e,this,!1)},this.setOptions(i),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.notify(!1,!1)}}const Oe=(t,i,e,n)=>{for(;t<=i;){const o=(t+i)/2|0,r=e(o);if(r<n)t=o+1;else if(r>n)i=o-1;else return o}return t>0?t-1:0};function Ze({measurements:t,outerSize:i,scrollOffset:e}){const n=t.length-1,r=Oe(0,n,a=>t[a].start,e);let l=r;for(;l<n&&t[l].end<e+i;)l++;return{startIndex:r,endIndex:l}}const et=typeof document<"u"?p.useLayoutEffect:p.useEffect;function tt(t){const i=p.useReducer(()=>({}),{})[1],e={...t,onChange:(o,r)=>{var l;r?ze.flushSync(i):i(),(l=t.onChange)==null||l.call(t,o,r)}},[n]=p.useState(()=>new Qe(e));return n.setOptions(e),p.useEffect(()=>n._didMount(),[]),et(()=>n._willUpdate()),n}function nt(t){return tt({observeElementRect:Je,observeElementOffset:Xe,scrollToFn:Ge,...t})}function ue(t,i){let[e,n]=p.useState(t),o=Ie(t);return L(()=>n(o.current),[o,n,...i]),e}function ot(t,i,e){let[n,o]=p.useState(e),r=t!==void 0,l=p.useRef(r),a=p.useRef(!1),c=p.useRef(!1);return r&&!l.current&&!a.current?(a.current=!0,l.current=r,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!r&&l.current&&!c.current&&(c.current=!0,l.current=r,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[r?t:n,g(u=>(r||o(u),i==null?void 0:i(u)))]}function ge(t){return[t.screenX,t.screenY]}function rt(){let t=p.useRef([-1,-1]);return{wasMoved(i){let e=ge(i);return t.current[0]===e[0]&&t.current[1]===e[1]?!1:(t.current=e,!0)},update(i){t.current=ge(i)}}}function it({container:t,accept:i,walk:e,enabled:n=!0}){let o=p.useRef(i),r=p.useRef(e);p.useEffect(()=>{o.current=i,r.current=e},[i,e]),L(()=>{if(!t||!n)return;let l=De(t);if(!l)return;let a=o.current,c=r.current,u=Object.assign(b=>a(b),{acceptNode:a}),f=l.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,u,!1);for(;f.nextNode();)c(f.currentNode)},[t,n,o,r])}function lt(t){throw new Error("Unexpected object: "+t)}var E=(t=>(t[t.First=0]="First",t[t.Previous=1]="Previous",t[t.Next=2]="Next",t[t.Last=3]="Last",t[t.Specific=4]="Specific",t[t.Nothing=5]="Nothing",t))(E||{});function xe(t,i){let e=i.resolveItems();if(e.length<=0)return null;let n=i.resolveActiveIndex(),o=n??-1;switch(t.focus){case 0:{for(let r=0;r<e.length;++r)if(!i.resolveDisabled(e[r],r,e))return r;return n}case 1:{for(let r=o-1;r>=0;--r)if(!i.resolveDisabled(e[r],r,e))return r;return n}case 2:{for(let r=o+1;r<e.length;++r)if(!i.resolveDisabled(e[r],r,e))return r;return n}case 3:{for(let r=e.length-1;r>=0;--r)if(!i.resolveDisabled(e[r],r,e))return r;return n}case 4:{for(let r=0;r<e.length;++r)if(i.resolveId(e[r],r,e)===t.id)return r;return n}case 5:return null;default:lt(t)}}function Se(t={},i=null,e=[]){for(let[n,o]of Object.entries(t))Ce(e,Re(i,n),o);return e}function Re(t,i){return t?t+"["+i+"]":i}function Ce(t,i,e){if(Array.isArray(e))for(let[n,o]of e.entries())Ce(t,Re(i,n.toString()),o);else e instanceof Date?t.push([i,e.toISOString()]):typeof e=="boolean"?t.push([i,e?"1":"0"]):typeof e=="string"?t.push([i,e]):typeof e=="number"?t.push([i,`${e}`]):e==null?t.push([i,""]):Se(e,i,t)}var st=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(st||{}),at=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(at||{}),ut=(t=>(t[t.Pointer=0]="Pointer",t[t.Focus=1]="Focus",t[t.Other=2]="Other",t))(ut||{}),ct=(t=>(t[t.OpenCombobox=0]="OpenCombobox",t[t.CloseCombobox=1]="CloseCombobox",t[t.GoToOption=2]="GoToOption",t[t.RegisterOption=3]="RegisterOption",t[t.UnregisterOption=4]="UnregisterOption",t[t.RegisterLabel=5]="RegisterLabel",t[t.SetActivationTrigger=6]="SetActivationTrigger",t[t.UpdateVirtualOptions=7]="UpdateVirtualOptions",t))(ct||{});function se(t,i=e=>e){let e=t.activeOptionIndex!==null?t.options[t.activeOptionIndex]:null,n=i(t.options.slice()),o=n.length>0&&n[0].dataRef.current.order!==null?n.sort((l,a)=>l.dataRef.current.order-a.dataRef.current.order):je(n,l=>l.dataRef.current.domRef.current),r=e?o.indexOf(e):null;return r===-1&&(r=null),{options:o,activeOptionIndex:r}}let dt={1(t){var i;return(i=t.dataRef.current)!=null&&i.disabled||t.comboboxState===1?t:{...t,activeOptionIndex:null,comboboxState:1}},0(t){var i,e;if((i=t.dataRef.current)!=null&&i.disabled||t.comboboxState===0)return t;if((e=t.dataRef.current)!=null&&e.value){let n=t.dataRef.current.calculateIndex(t.dataRef.current.value);if(n!==-1)return{...t,activeOptionIndex:n,comboboxState:0}}return{...t,comboboxState:0}},2(t,i){var e,n,o,r,l;if((e=t.dataRef.current)!=null&&e.disabled||(n=t.dataRef.current)!=null&&n.optionsRef.current&&!((o=t.dataRef.current)!=null&&o.optionsPropsRef.current.static)&&t.comboboxState===1)return t;if(t.virtual){let f=i.focus===E.Specific?i.idx:xe(i,{resolveItems:()=>t.virtual.options,resolveActiveIndex:()=>{var C,s;return(s=(C=t.activeOptionIndex)!=null?C:t.virtual.options.findIndex(h=>!t.virtual.disabled(h)))!=null?s:null},resolveDisabled:t.virtual.disabled,resolveId(){throw new Error("Function not implemented.")}}),b=(r=i.trigger)!=null?r:2;return t.activeOptionIndex===f&&t.activationTrigger===b?t:{...t,activeOptionIndex:f,activationTrigger:b}}let a=se(t);if(a.activeOptionIndex===null){let f=a.options.findIndex(b=>!b.dataRef.current.disabled);f!==-1&&(a.activeOptionIndex=f)}let c=i.focus===E.Specific?i.idx:xe(i,{resolveItems:()=>a.options,resolveActiveIndex:()=>a.activeOptionIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled}),u=(l=i.trigger)!=null?l:2;return t.activeOptionIndex===c&&t.activationTrigger===u?t:{...t,...a,activeOptionIndex:c,activationTrigger:u}},3:(t,i)=>{var e,n,o;if((e=t.dataRef.current)!=null&&e.virtual)return{...t,options:[...t.options,i.payload]};let r=i.payload,l=se(t,c=>(c.push(r),c));t.activeOptionIndex===null&&(n=t.dataRef.current)!=null&&n.isSelected(i.payload.dataRef.current.value)&&(l.activeOptionIndex=l.options.indexOf(r));let a={...t,...l,activationTrigger:2};return(o=t.dataRef.current)!=null&&o.__demoMode&&t.dataRef.current.value===void 0&&(a.activeOptionIndex=0),a},4:(t,i)=>{var e;if((e=t.dataRef.current)!=null&&e.virtual)return{...t,options:t.options.filter(o=>o.id!==i.id)};let n=se(t,o=>{let r=o.findIndex(l=>l.id===i.id);return r!==-1&&o.splice(r,1),o});return{...t,...n,activationTrigger:2}},5:(t,i)=>t.labelId===i.id?t:{...t,labelId:i.id},6:(t,i)=>t.activationTrigger===i.trigger?t:{...t,activationTrigger:i.trigger},7:(t,i)=>{var e;if(((e=t.virtual)==null?void 0:e.options)===i.options)return t;let n=t.activeOptionIndex;if(t.activeOptionIndex!==null){let o=i.options.indexOf(t.virtual.options[t.activeOptionIndex]);o!==-1?n=o:n=null}return{...t,activeOptionIndex:n,virtual:Object.assign({},t.virtual,{options:i.options})}}},ce=p.createContext(null);ce.displayName="ComboboxActionsContext";function Q(t){let i=p.useContext(ce);if(i===null){let e=new Error(`<${t} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,Q),e}return i}let Te=p.createContext(null);function pt(t){var i;let e=j("VirtualProvider"),[n,o]=p.useMemo(()=>{let c=e.optionsRef.current;if(!c)return[0,0];let u=window.getComputedStyle(c);return[parseFloat(u.paddingBlockStart||u.paddingTop),parseFloat(u.paddingBlockEnd||u.paddingBottom)]},[e.optionsRef.current]),r=nt({scrollPaddingStart:n,scrollPaddingEnd:o,count:e.virtual.options.length,estimateSize(){return 40},getScrollElement(){var c;return(c=e.optionsRef.current)!=null?c:null},overscan:12}),[l,a]=p.useState(0);return L(()=>{a(c=>c+1)},[(i=e.virtual)==null?void 0:i.options]),N.createElement(Te.Provider,{value:r},N.createElement("div",{style:{position:"relative",width:"100%",height:`${r.getTotalSize()}px`},ref:c=>{if(c){if(typeof process<"u"&&{}.JEST_WORKER_ID!==void 0||e.activationTrigger===0)return;e.activeOptionIndex!==null&&e.virtual.options.length>e.activeOptionIndex&&r.scrollToIndex(e.activeOptionIndex)}}},r.getVirtualItems().map(c=>{var u;return N.createElement(p.Fragment,{key:c.key},N.cloneElement((u=t.children)==null?void 0:u.call(t,{option:e.virtual.options[c.index],open:e.comboboxState===0}),{key:`${l}-${c.key}`,"data-index":c.index,"aria-setsize":e.virtual.options.length,"aria-posinset":c.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${c.start}px)`,overflowAnchor:"none"}}))})))}let de=p.createContext(null);de.displayName="ComboboxDataContext";function j(t){let i=p.useContext(de);if(i===null){let e=new Error(`<${t} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,j),e}return i}function ft(t,i){return q(i.type,dt,t,i)}let ht=p.Fragment;function mt(t,i){let{value:e,defaultValue:n,onChange:o,form:r,name:l,by:a=null,disabled:c=!1,__demoMode:u=!1,nullable:f=!1,multiple:b=!1,immediate:C=!1,virtual:s=null,...h}=t,O=!1,x=null,[v=b?[]:void 0,M]=ot(e,o,n),[w,P]=p.useReducer(ft,{dataRef:p.createRef(),comboboxState:u?0:1,options:[],virtual:null,activeOptionIndex:null,activationTrigger:2,labelId:null}),$=p.useRef(!1),B=p.useRef({static:!1,hold:!1}),K=p.useRef(null),U=p.useRef(null),W=p.useRef(null),R=p.useRef(null),S=g(typeof a=="string"?(m,I)=>{let F=a;return(m==null?void 0:m[F])===(I==null?void 0:I[F])}:a??((m,I)=>m===I)),D=g(m=>w.options.findIndex(I=>S(I.dataRef.current.value,m))),ne=p.useCallback(m=>q(d.mode,{1:()=>v.some(I=>S(I,m)),0:()=>S(v,m)}),[v]),oe=g(m=>w.activeOptionIndex===D(m)),d=p.useMemo(()=>({...w,immediate:O,optionsPropsRef:B,labelRef:K,inputRef:U,buttonRef:W,optionsRef:R,value:v,defaultValue:n,disabled:c,mode:b?1:0,virtual:w.virtual,get activeOptionIndex(){if($.current&&w.activeOptionIndex===null&&w.options.length>0){let m=w.options.findIndex(I=>!I.dataRef.current.disabled);if(m!==-1)return m}return w.activeOptionIndex},calculateIndex:D,compare:S,isSelected:ne,isActive:oe,nullable:f,__demoMode:u}),[v,n,c,b,f,u,w,x]);L(()=>{},[x,void 0]),L(()=>{w.dataRef.current=d},[d]),_e([d.buttonRef,d.inputRef,d.optionsRef],()=>ie.closeCombobox(),d.comboboxState===0);let z=p.useMemo(()=>{var m,I,F;return{open:d.comboboxState===0,disabled:c,activeIndex:d.activeOptionIndex,activeOption:d.activeOptionIndex===null?null:d.virtual?d.virtual.options[(m=d.activeOptionIndex)!=null?m:0]:(F=(I=d.options[d.activeOptionIndex])==null?void 0:I.dataRef.current.value)!=null?F:null,value:v}},[d,c,v]),y=g(()=>{if(d.activeOptionIndex!==null){if(d.virtual)re(d.virtual.options[d.activeOptionIndex]);else{let{dataRef:m}=d.options[d.activeOptionIndex];re(m.current.value)}ie.goToOption(E.Specific,d.activeOptionIndex)}}),k=g(()=>{P({type:0}),$.current=!0}),T=g(()=>{P({type:1}),$.current=!1}),A=g((m,I,F)=>($.current=!1,m===E.Specific?P({type:2,focus:E.Specific,idx:I,trigger:F}):P({type:2,focus:m,trigger:F}))),V=g((m,I)=>(P({type:3,payload:{id:m,dataRef:I}}),()=>{d.isActive(I.current.value)&&($.current=!0),P({type:4,id:m})})),Ee=g(m=>(P({type:5,id:m}),()=>P({type:5,id:null}))),re=g(m=>q(d.mode,{0(){return M==null?void 0:M(m)},1(){let I=d.value.slice(),F=I.findIndex(ee=>S(ee,m));return F===-1?I.push(m):I.splice(F,1),M==null?void 0:M(I)}})),ye=g(m=>{P({type:6,trigger:m})}),ie=p.useMemo(()=>({onChange:re,registerOption:V,registerLabel:Ee,goToOption:A,closeCombobox:T,openCombobox:k,setActivationTrigger:ye,selectActiveOption:y}),[]),Me=i===null?{}:{ref:i},Z=p.useRef(null),we=ae();return p.useEffect(()=>{Z.current&&n!==void 0&&we.addEventListener(Z.current,"reset",()=>{M==null||M(n)})},[Z,M]),N.createElement(ce.Provider,{value:ie},N.createElement(de.Provider,{value:d},N.createElement(Pe,{value:q(d.comboboxState,{0:te.Open,1:te.Closed})},l!=null&&v!=null&&Se({[l]:v}).map(([m,I],F)=>N.createElement(ke,{features:Le.Hidden,ref:F===0?ee=>{var pe;Z.current=(pe=ee==null?void 0:ee.closest("form"))!=null?pe:null}:void 0,...$e({key:m,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:r,disabled:c,name:m,value:I})})),J({ourProps:Me,theirProps:h,slot:z,defaultTag:ht,name:"Combobox"}))))}let vt="input";function bt(t,i){var e,n,o,r,l;let a=G(),{id:c=`headlessui-combobox-input-${a}`,onChange:u,displayValue:f,type:b="text",...C}=t,s=j("Combobox.Input"),h=Q("Combobox.Input"),O=Y(s.inputRef,i),x=Ne(s.inputRef),v=p.useRef(!1),M=ae(),w=g(()=>{h.onChange(null),s.optionsRef.current&&(s.optionsRef.current.scrollTop=0),h.goToOption(E.Nothing)}),P=function(){var d;return typeof f=="function"&&s.value!==void 0?(d=f(s.value))!=null?d:"":typeof s.value=="string"?s.value:""}();me(([d,z],[y,k])=>{if(v.current)return;let T=s.inputRef.current;T&&((k===0&&z===1||d!==y)&&(T.value=d),requestAnimationFrame(()=>{if(v.current||!T||(x==null?void 0:x.activeElement)!==T)return;let{selectionStart:A,selectionEnd:V}=T;Math.abs((V??0)-(A??0))===0&&A===0&&T.setSelectionRange(T.value.length,T.value.length)}))},[P,s.comboboxState,x]),me(([d],[z])=>{if(d===0&&z===1){if(v.current)return;let y=s.inputRef.current;if(!y)return;let k=y.value,{selectionStart:T,selectionEnd:A,selectionDirection:V}=y;y.value="",y.value=k,V!==null?y.setSelectionRange(T,A,V):y.setSelectionRange(T,A)}},[s.comboboxState]);let $=p.useRef(!1),B=g(()=>{$.current=!0}),K=g(()=>{M.nextFrame(()=>{$.current=!1})}),U=g(d=>{switch(v.current=!0,d.key){case _.Enter:if(v.current=!1,s.comboboxState!==0||$.current)return;if(d.preventDefault(),d.stopPropagation(),s.activeOptionIndex===null){h.closeCombobox();return}h.selectActiveOption(),s.mode===0&&h.closeCombobox();break;case _.ArrowDown:return v.current=!1,d.preventDefault(),d.stopPropagation(),q(s.comboboxState,{0:()=>h.goToOption(E.Next),1:()=>h.openCombobox()});case _.ArrowUp:return v.current=!1,d.preventDefault(),d.stopPropagation(),q(s.comboboxState,{0:()=>h.goToOption(E.Previous),1:()=>{h.openCombobox(),M.nextFrame(()=>{s.value||h.goToOption(E.Last)})}});case _.Home:if(d.shiftKey)break;return v.current=!1,d.preventDefault(),d.stopPropagation(),h.goToOption(E.First);case _.PageUp:return v.current=!1,d.preventDefault(),d.stopPropagation(),h.goToOption(E.First);case _.End:if(d.shiftKey)break;return v.current=!1,d.preventDefault(),d.stopPropagation(),h.goToOption(E.Last);case _.PageDown:return v.current=!1,d.preventDefault(),d.stopPropagation(),h.goToOption(E.Last);case _.Escape:return v.current=!1,s.comboboxState!==0?void 0:(d.preventDefault(),s.optionsRef.current&&!s.optionsPropsRef.current.static&&d.stopPropagation(),s.nullable&&s.mode===0&&s.value===null&&w(),h.closeCombobox());case _.Tab:if(v.current=!1,s.comboboxState!==0)return;s.mode===0&&s.activationTrigger!==1&&h.selectActiveOption(),h.closeCombobox();break}}),W=g(d=>{u==null||u(d),s.nullable&&s.mode===0&&d.target.value===""&&w(),h.openCombobox()}),R=g(d=>{var z,y,k;let T=(z=d.relatedTarget)!=null?z:ve.find(A=>A!==d.currentTarget);if(v.current=!1,!((y=s.optionsRef.current)!=null&&y.contains(T))&&!((k=s.buttonRef.current)!=null&&k.contains(T))&&s.comboboxState===0)return d.preventDefault(),s.mode===0&&(s.nullable&&s.value===null?w():s.activationTrigger!==1&&h.selectActiveOption()),h.closeCombobox()}),S=g(d=>{var z,y,k;let T=(z=d.relatedTarget)!=null?z:ve.find(A=>A!==d.currentTarget);(y=s.buttonRef.current)!=null&&y.contains(T)||(k=s.optionsRef.current)!=null&&k.contains(T)||s.disabled||s.immediate&&s.comboboxState!==0&&(h.openCombobox(),M.nextFrame(()=>{h.setActivationTrigger(1)}))}),D=ue(()=>{if(s.labelId)return[s.labelId].join(" ")},[s.labelId]),ne=p.useMemo(()=>({open:s.comboboxState===0,disabled:s.disabled}),[s]),oe={ref:O,id:c,role:"combobox",type:b,"aria-controls":(e=s.optionsRef.current)==null?void 0:e.id,"aria-expanded":s.comboboxState===0,"aria-activedescendant":s.activeOptionIndex===null?void 0:s.virtual?(n=s.options.find(d=>{var z;return!((z=s.virtual)!=null&&z.disabled(d.dataRef.current.value))&&s.compare(d.dataRef.current.value,s.virtual.options[s.activeOptionIndex])}))==null?void 0:n.id:(o=s.options[s.activeOptionIndex])==null?void 0:o.id,"aria-labelledby":D,"aria-autocomplete":"list",defaultValue:(l=(r=t.defaultValue)!=null?r:s.defaultValue!==void 0?f==null?void 0:f(s.defaultValue):null)!=null?l:s.defaultValue,disabled:s.disabled,onCompositionStart:B,onCompositionEnd:K,onKeyDown:U,onChange:W,onFocus:S,onBlur:R};return J({ourProps:oe,theirProps:C,slot:ne,defaultTag:vt,name:"Combobox.Input"})}let gt="button";function xt(t,i){var e;let n=j("Combobox.Button"),o=Q("Combobox.Button"),r=Y(n.buttonRef,i),l=G(),{id:a=`headlessui-combobox-button-${l}`,...c}=t,u=ae(),f=g(O=>{switch(O.key){case _.ArrowDown:return O.preventDefault(),O.stopPropagation(),n.comboboxState===1&&o.openCombobox(),u.nextFrame(()=>{var x;return(x=n.inputRef.current)==null?void 0:x.focus({preventScroll:!0})});case _.ArrowUp:return O.preventDefault(),O.stopPropagation(),n.comboboxState===1&&(o.openCombobox(),u.nextFrame(()=>{n.value||o.goToOption(E.Last)})),u.nextFrame(()=>{var x;return(x=n.inputRef.current)==null?void 0:x.focus({preventScroll:!0})});case _.Escape:return n.comboboxState!==0?void 0:(O.preventDefault(),n.optionsRef.current&&!n.optionsPropsRef.current.static&&O.stopPropagation(),o.closeCombobox(),u.nextFrame(()=>{var x;return(x=n.inputRef.current)==null?void 0:x.focus({preventScroll:!0})}));default:return}}),b=g(O=>{if(Ae(O.currentTarget))return O.preventDefault();n.comboboxState===0?o.closeCombobox():(O.preventDefault(),o.openCombobox()),u.nextFrame(()=>{var x;return(x=n.inputRef.current)==null?void 0:x.focus({preventScroll:!0})})}),C=ue(()=>{if(n.labelId)return[n.labelId,a].join(" ")},[n.labelId,a]),s=p.useMemo(()=>({open:n.comboboxState===0,disabled:n.disabled,value:n.value}),[n]),h={ref:r,id:a,type:Be(t,n.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(e=n.optionsRef.current)==null?void 0:e.id,"aria-expanded":n.comboboxState===0,"aria-labelledby":C,disabled:n.disabled,onClick:b,onKeyDown:f};return J({ourProps:h,theirProps:c,slot:s,defaultTag:gt,name:"Combobox.Button"})}let It="label";function Ot(t,i){let e=G(),{id:n=`headlessui-combobox-label-${e}`,...o}=t,r=j("Combobox.Label"),l=Q("Combobox.Label"),a=Y(r.labelRef,i);L(()=>l.registerLabel(n),[n]);let c=g(()=>{var f;return(f=r.inputRef.current)==null?void 0:f.focus({preventScroll:!0})}),u=p.useMemo(()=>({open:r.comboboxState===0,disabled:r.disabled}),[r]);return J({ourProps:{ref:a,id:n,onClick:c},theirProps:o,slot:u,defaultTag:It,name:"Combobox.Label"})}let St="ul",Rt=fe.RenderStrategy|fe.Static;function Ct(t,i){let e=G(),{id:n=`headlessui-combobox-options-${e}`,hold:o=!1,...r}=t,l=j("Combobox.Options"),a=Y(l.optionsRef,i),c=Fe(),u=(()=>c!==null?(c&te.Open)===te.Open:l.comboboxState===0)();L(()=>{var s;l.optionsPropsRef.current.static=(s=t.static)!=null?s:!1},[l.optionsPropsRef,t.static]),L(()=>{l.optionsPropsRef.current.hold=o},[l.optionsPropsRef,o]),it({container:l.optionsRef.current,enabled:l.comboboxState===0,accept(s){return s.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:s.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(s){s.setAttribute("role","none")}});let f=ue(()=>{var s,h;return(h=l.labelId)!=null?h:(s=l.buttonRef.current)==null?void 0:s.id},[l.labelId,l.buttonRef.current]),b=p.useMemo(()=>({open:l.comboboxState===0,option:void 0}),[l]),C={"aria-labelledby":f,role:"listbox","aria-multiselectable":l.mode===1?!0:void 0,id:n,ref:a};return l.virtual&&l.comboboxState===0&&Object.assign(r,{children:N.createElement(pt,null,r.children)}),J({ourProps:C,theirProps:r,slot:b,defaultTag:St,features:Rt,visible:u,name:"Combobox.Options"})}let Tt="li";function Et(t,i){var e;let n=G(),{id:o=`headlessui-combobox-option-${n}`,disabled:r=!1,value:l,order:a=null,...c}=t,u=j("Combobox.Option"),f=Q("Combobox.Option"),b=u.virtual?u.activeOptionIndex===u.calculateIndex(l):u.activeOptionIndex===null?!1:((e=u.options[u.activeOptionIndex])==null?void 0:e.id)===o,C=u.isSelected(l),s=p.useRef(null),h=Ie({disabled:r,value:l,domRef:s,order:a}),O=p.useContext(Te),x=Y(i,s,O?O.measureElement:null),v=g(()=>f.onChange(l));L(()=>f.registerOption(o,h),[h,o]);let M=p.useRef(!(u.virtual||u.__demoMode));L(()=>{if(!u.virtual||!u.__demoMode)return;let R=he();return R.requestAnimationFrame(()=>{M.current=!0}),R.dispose},[u.virtual,u.__demoMode]),L(()=>{if(!M.current||u.comboboxState!==0||!b||u.activationTrigger===0)return;let R=he();return R.requestAnimationFrame(()=>{var S,D;(D=(S=s.current)==null?void 0:S.scrollIntoView)==null||D.call(S,{block:"nearest"})}),R.dispose},[s,b,u.comboboxState,u.activationTrigger,u.activeOptionIndex]);let w=g(R=>{var S;if(r||(S=u.virtual)!=null&&S.disabled(l))return R.preventDefault();v(),Ve()||requestAnimationFrame(()=>{var D;return(D=u.inputRef.current)==null?void 0:D.focus({preventScroll:!0})}),u.mode===0&&requestAnimationFrame(()=>f.closeCombobox())}),P=g(()=>{var R;if(r||(R=u.virtual)!=null&&R.disabled(l))return f.goToOption(E.Nothing);let S=u.calculateIndex(l);f.goToOption(E.Specific,S)}),$=rt(),B=g(R=>$.update(R)),K=g(R=>{var S;if(!$.wasMoved(R)||r||(S=u.virtual)!=null&&S.disabled(l)||b)return;let D=u.calculateIndex(l);f.goToOption(E.Specific,D,0)}),U=g(R=>{var S;$.wasMoved(R)&&(r||(S=u.virtual)!=null&&S.disabled(l)||b&&(u.optionsPropsRef.current.hold||f.goToOption(E.Nothing)))}),W=p.useMemo(()=>({active:b,selected:C,disabled:r}),[b,C,r]);return J({ourProps:{id:o,ref:x,role:"option",tabIndex:r===!0?void 0:-1,"aria-disabled":r===!0?!0:void 0,"aria-selected":C,disabled:void 0,onClick:w,onFocus:P,onPointerEnter:B,onMouseEnter:B,onPointerMove:K,onMouseMove:K,onPointerLeave:U,onMouseLeave:U},theirProps:c,slot:W,defaultTag:Tt,name:"Combobox.Option"})}let yt=H(mt),Mt=H(xt),wt=H(bt),zt=H(Ot),Pt=H(Ct),$t=H(Et),Lt=Object.assign(yt,{Input:wt,Button:Mt,Label:zt,Options:Pt,Option:$t});export{Lt as q};
