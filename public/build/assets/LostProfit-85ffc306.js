import{r as a,j as e,Y as pe,y as je,a as H}from"./app-cbf17b2f.js";import{D as U,A as fe}from"./AuthenticatedLayout-6f8557f9.js";import{H as ve}from"./Header-00f70671.js";import{t as Y,u as be,c as ye}from"./index.esm-2100d3a1.js";import{S as Ne}from"./SecondaryButton-6ebfe1f6.js";import{e as $}from"./index.esm-1f0a2809.js";import{P as we}from"./PrimaryButton-94d3e012.js";import{f as M}from"./formatNumber-b542c689.js";import{d as j}from"./dayjs.min-0b56d0db.js";import y from"./LostProfitContent-55ff9bdc.js";import{I as P}from"./InputLabel-c23942c9.js";import{C as L}from"./ClientSelectInput-9cb185a7.js";import{j as k}from"./disclosure-c0bafe63.js";import{z as ge}from"./transition-81061bb8.js";import"./ApplicationLogo-1db27b10.js";import"./iconBase-e5b65cfa.js";/* empty css                      */import"./combobox-394d7890.js";import"./portal-0df7910e.js";import"./close-provider-764fbaad.js";function De({organization:r,ledgers:E,startDateFilter:S,endDateFilter:C,projects:N,programs:w,departments:g,project:m,program:x,department:u}){const[h,z]=a.useState(E||[]),[f,_]=a.useState(S||""),[v,q]=a.useState(C||""),[p,G]=a.useState(0),[J,Q]=a.useState({startDate:S||"",endDate:S||""}),[W,X]=a.useState({startDate:C||"",endDate:C||""}),[i,Z]=a.useState({accountCode:!1}),[b,ee]=a.useState(0),[t,se]=a.useState({variable:0,fixed:0,depreciated:0,other:0}),[te,D]=a.useState(!1),[n,R]=a.useState({id:m?m.id:null,name:m?m.name:"",code:m?m.code:""}),[ae,Se]=a.useState(""),[d,B]=a.useState({id:x?x.id:null,name:x?x.name:"",code:x?x.code:""}),[le,Ce]=a.useState(""),[o,I]=a.useState({id:u?u.id:null,name:u?u.name:"",code:u?u.code:""}),[re,Ye]=a.useState("");a.useEffect(()=>{F(E)},[]);const ie=s=>{B(s)},ne=()=>{B({id:null,name:"",code:""})},de=s=>{R(s)},oe=()=>{R({id:null,name:"",code:""})},ce=s=>{I(s)},me=()=>{I({id:null,name:"",code:""})},F=s=>{let c=0,T=0,A=0,O=0,V=0;s.map(l=>{l.code>="400000000"&&l.code<="499999999"&&(c+=parseInt(l.total)),l.code>="500000000"&&l.code<="599999999"&&(T+=parseInt(l.total)),l.code>="600000000"&&l.code<="699999999"&&(A+=parseInt(l.total)),l.code>="700000000"&&l.code<="799999999"&&(O+=parseInt(l.total)),l.code>="800000000"&&l.code<="899999999"&&(V+=parseInt(l.total))}),z(s),ee(c*-1),se({variable:T,fixed:A,depreciated:O,other:V})},xe=s=>{Q(s),_(j(s.endDate).format("YYYY-MM-DD"))},ue=s=>{X(s),q(j(s.endDate).format("YYYY-MM-DD"))},he=()=>{je.reload({only:["ledgers"],data:{startDate:f,endDate:v,program:d.id,project:n.id,department:o.id},onBefore:s=>{s.completed?D(!1):D(!0)},onSuccess:s=>{F(s.props.ledgers)},onError:s=>{console.log(s)},onFinish:s=>{s.completed?D(!1):D(!0)},preserveState:!0})},K=()=>{window.print()};return e.jsxs(e.Fragment,{children:[e.jsx(pe,{title:`Laporan ${p>0?"Surplus Defisit":"Laba Rugi"} Periode : ${j(f).format("MMMM DD, YYYY")} - ${j(v).format("MMMM DD, YYYY")}`}),e.jsx("div",{className:"sm:pt-0 pb-16 pt-12",children:e.jsxs("div",{className:"bg-white py-2 sm:pt-0 px-5",children:[e.jsxs("div",{className:"flex sm:flex-row justify-between gap-2 print:hidden",children:[e.jsxs("div",{className:"px-3 my-auto flex gap-3",children:[e.jsx("div",{className:"my-auto",children:e.jsxs("select",{className:"w-full rounded-lg border-gray-300",onChange:s=>G(s.target.value),value:p,children:[e.jsx("option",{value:0,children:"Laba Rugi"}),e.jsx("option",{value:1,children:"Surplus Defisit"})]})}),e.jsx("div",{className:"my-auto",children:e.jsx(U,{value:J,onChange:xe,useRange:!1,asSingle:!0,placeholder:"Tanggal Awal",id:"date",displayFormat:"MMMM DD, YYYY"})}),e.jsx("div",{className:"my-auto",children:e.jsx(U,{value:W,onChange:ue,useRange:!1,asSingle:!0,placeholder:"Tanggal Akhir",id:"date",displayFormat:"MMMM DD, YYYY"})}),e.jsx("div",{className:"my-auto",children:e.jsx(we,{disabled:!f||!v||f>v||te,onClick:he,children:"Filter"})})]}),e.jsx("div",{className:"text-end px-3 hidden sm:block",children:e.jsx(Ne,{onClick:K,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"my-auto",children:e.jsx($,{})}),e.jsx("div",{className:"my-auto",children:"Print"})]})})}),e.jsx("div",{className:"fixed sm:hidden bottom-2 right-2",children:e.jsx("button",{onClick:K,className:"bg-white border-2 border-slate-900 p-2 rounded-full h-14 w-14",children:e.jsx("div",{className:"flex gap-2",children:e.jsx("div",{className:"my-auto mx-auto",children:e.jsx($,{})})})})})]}),e.jsx(k,{as:"div",className:"mt-3 print:hidden",children:({open:s})=>e.jsxs(e.Fragment,{children:[e.jsx(ge,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsxs(k.Panel,{children:[w.length>0||N.length>0||g.length?e.jsxs("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:[w.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(P,{value:"Program Kegiatan",htmlFor:"program"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(L,{resources:w,selected:d,setSelected:c=>ie(c),maxHeight:"max-h-40",placeholder:"Cari Program Kegiatan",isError:!!le,id:"program"}),d.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",d.code]})]}),d.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:ne,children:e.jsx(Y,{})})})]})]}),N.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(P,{value:"Proyek",htmlFor:"project"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(L,{resources:N,selected:n,setSelected:c=>de(c),maxHeight:"max-h-40",placeholder:"Cari Proyek",isError:!!ae,id:"project"}),n.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",n.code]})]}),n.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:oe,children:e.jsx(Y,{})})})]})]}),g.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(P,{value:"Departemen",htmlFor:"department"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(L,{resources:g,selected:o,setSelected:c=>ce(c),maxHeight:"max-h-40",placeholder:"Cari Departemen",isError:!!re,id:"department"}),o.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",o.code]})]}),o.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:me,children:e.jsx(Y,{})})})]})]})]}):"",e.jsx("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer gap-2",htmlFor:"checkbox",children:[e.jsx("input",{type:"checkbox",className:"checkbox",id:"checkbox",value:i.accountCode,onChange:()=>Z({...i.accountCode,accountCode:!i.accountCode}),checked:i.accountCode}),e.jsx("span",{className:"label-text",children:"Tampilkan Kode Akun"})]})})})]})}),e.jsx(k.Button,{className:"flex w-full justify-between rounded-lg bg-slate-100 px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-slate-500/75",children:e.jsxs("div",{className:"flex justify-center w-full gap-3",children:[e.jsx("span",{children:"Tampilkan Lebih Banyak"}),e.jsx(be,{className:`${s?"":"rotate-180 transform"} h-5 w-5 text-slate-500`})]})})]})}),e.jsxs("div",{className:"uppercase pt-9 pb-3 border-b hidden print:flex print:justify-between",children:[e.jsxs("div",{className:"w-1/2 text-2xl my-auto",children:["Laporan ",p>0?"Surplus Defisit":"Laba Rugi"]}),e.jsxs("div",{className:"w-1/2 text-end mt-auto",children:[e.jsx("div",{children:r.name}),e.jsx("div",{className:"text-xs",children:r.address}),e.jsxs("div",{className:"text-xs",children:[r.village,", ",r.district,", ",r.regency,","," ",r.province]})]})]}),e.jsxs("div",{className:"w-full mt-3 hidden print:flex print:justify-between",children:[e.jsxs("div",{className:"text-end italic ",children:["Periode : ",j(f).format("MMMM DD, YYYY")," -"," ",j(v).format("MMMM DD, YYYY")]}),e.jsx("div",{className:"text-xs my-auto",children:w.length>0||N.length>0||g.length>0?e.jsxs("div",{children:[d.name&&e.jsxs("div",{children:["Program Kegiatan: ",d.code,"-",d.name.toUpperCase()]}),n.name&&e.jsxs("div",{children:["Proyek : ",n.code,"-",n.name.toUpperCase()]}),o.name&&e.jsxs("div",{children:["Departemen : ",o.code,"-",o.name.toUpperCase()]})]}):""})]}),e.jsx("div",{className:"my-2 space-y-3 mx-3 print:font-['Open_Sans'] overflow-auto",children:e.jsxs("div",{className:"sm:w-3/4 w-[550px] print:w-full",children:[b>0&&e.jsx(y,{ledgers:h,title:"Pendapatan",showCode:i.accountCode,type:"revenue",amount:b}),t.variable>0&&e.jsx(y,{ledgers:h,title:"Biaya Variabel",showCode:i.accountCode,type:"variable-cost",amount:t.variable}),t.fixed>0&&e.jsx(y,{ledgers:h,title:"Biaya Operasional",showCode:i.accountCode,type:"fixed-cost",amount:t.fixed}),t.depreciated>0&&e.jsx(y,{ledgers:h,title:"Biaya Penyusutan",showCode:i.accountCode,type:"depreciated-cost",amount:t.depreciated}),t.other>0&&e.jsx(y,{ledgers:h,title:"Biaya Lain",showCode:i.accountCode,type:"other-cost",amount:t.other}),h.length>0&&e.jsxs("div",{className:"mt-5",children:[e.jsxs("div",{className:"flex w-full justify-between py-2 font-bold",children:[e.jsxs("div",{className:"w-5/12 print:w-8/12 uppercase flex gap-2",children:[p>0?"Surplus":"Laba"," Kotor"]}),e.jsxs("div",{className:"w-2/12 print:w-4/12 text-center flex justify-end gap-3",children:[e.jsx("div",{className:"w-1/4 print:w-2/4 text-end",children:"Rp. "}),e.jsx("div",{className:"w-3/4 print:w-2/4 text-end",children:M(b-t.variable)})]})]}),e.jsxs("div",{className:"flex w-full justify-between py-2 font-bold",children:[e.jsxs("div",{className:"w-5/12 print:w-8/12 uppercase flex gap-2",children:[p>0?"Surplus":"Laba"," Bersih"]}),e.jsxs("div",{className:"w-2/12 print:w-4/12 text-center flex justify-end gap-3",children:[e.jsx("div",{className:"w-1/4 print:w-2/4 text-end",children:"Rp. "}),e.jsx("div",{className:"w-3/4 print:w-2/4 text-end",children:M(b-(t.variable+t.fixed))})]})]}),(t.depreciated>0||t.other>0)&&e.jsxs("div",{className:"flex w-full justify-between py-2 font-bold",children:[e.jsxs("div",{className:"w-5/12 print:w-8/12 uppercase flex gap-2",children:[p>0?"Surplus":"Laba"," Bersih Setelah Biaya Lain"]}),e.jsxs("div",{className:"w-2/12 print:w-4/12 text-center flex justify-end gap-3",children:[e.jsx("div",{className:"w-1/4 print:w-2/4 text-end",children:"Rp. "}),e.jsx("div",{className:"w-3/4 print:w-2/4 text-end",children:M(b-(t.variable+t.fixed+t.depreciated+t.other))})]})]})]})]})})]})})]})}De.layout=r=>e.jsx(fe,{header:e.jsx(ve,{children:"Laporan Laba Rugi"}),children:r,user:r.props.auth.user,organization:r.props.organization,title:"Laporan Laba Rugi",backLink:e.jsx(H,{href:route("report",r.props.organization.id),children:e.jsx(ye,{})}),breadcrumbs:e.jsx("div",{className:"text-sm breadcrumbs",children:e.jsxs("ul",{children:[e.jsx("li",{className:"font-bold",children:e.jsx(H,{href:route("report",r.props.organization.id),children:"Laporan"})}),e.jsx("li",{children:"Laporan Laba Rugi"})]})}),role:r.props.role});export{De as default};
