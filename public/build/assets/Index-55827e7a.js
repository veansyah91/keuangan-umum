import{r as i,W,y as g,j as e,Y,a as r}from"./app-ad4257d5.js";import{D as q,A as J}from"./AuthenticatedLayout-d335000d.js";import{H as X}from"./Header-f91aa4a0.js";import{I as j,a as p,k as Z,b as ee,d as ae,c as se}from"./index.esm-c0a97de4.js";import{o as F,u as te}from"./index.module-411b404b.js";import{f as N}from"./formatNumber-b542c689.js";import{M as I}from"./Modal-e8efdc72.js";import{I as v}from"./InputLabel-b46afe51.js";import{S as A}from"./SecondaryButton-f5ea60a7.js";import{P as T}from"./PrimaryButton-6102adfd.js";import{T as le,a as ie,C as ne}from"./ContentDesktop-0033c993.js";import{C as re}from"./ContentMobile-d77f6b90.js";import{C as ce}from"./ContainerDesktop-1c68b071.js";import{G as de}from"./index.esm-a567e8fc.js";import{T as b}from"./TextInput-d4fc5d93.js";import"./ApplicationLogo-ed865fd2.js";import"./iconBase-a1a0f175.js";import"./transition-1e2b0758.js";/* empty css                      */import"./dayjs.min-0ca5a2a2.js";import"./portal-8468025e.js";import"./close-provider-3c7c4627.js";const oe=s=>{const x=/(\d+)/;return s.split(x).filter(w=>w!=="")};function me({users:s,userCollections:x,searchFilter:y,affiliateCodeRecommendation:w,affiliationFilterQuery:P}){const[$,c]=i.useState(!1);i.useState(!1),i.useState(!1);const[l,C]=i.useState(y||""),[d,B]=i.useState({startDate:"",endDate:""});i.useState(!1);const[M,h]=i.useState(!1),[R]=F(l,500),[V]=F(d,500),E=te(l),{data:n,setData:f,patch:U,errors:t,processing:z}=W({id:null,name:"",no_ref:"",insentive:10}),[u,K]=i.useState(P=="true");i.useEffect(()=>{E!==void 0&&G()},[R,V]);const G=()=>{g.reload({only:["users","userCollections"],data:{search:l,start_date:d.startDate,end_date:d.endDate}})},S=a=>{B(a)},H=a=>{h(!0);let o=a.name.replace(/\s+/g,"");g.reload({only:["affiliateCodeRecommendation"],data:{name:o.toUpperCase()},onSuccess:({props:k})=>{let _=n,m=o.toUpperCase();if(k.affiliateCodeRecommendation){let D=oe(k.affiliateCodeRecommendation.no_ref);if(D.length>1){let Q=parseInt(D[1])+1;m=m+Q.toString()}else m=m+"1"}_={...n,id:a.id,name:a.name,no_ref:m},f(_)}})},L=a=>{a.preventDefault(),U(route("admin.user.store.affiliation",n.id),{onSuccess:()=>{console.log("success"),h(!1)}})},O=a=>{a.preventDefault(),g.reload({only:["userCollections"],data:{affiliationFilterQuery:u},preserveState:!0}),c(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Pengguna"}),e.jsx(le,{zIndex:"z-50",search:l,setSearch:a=>C(a.target.value),pageBefore:s.links[0].url?e.jsx(r,{href:`/admin/users?page=${s.current_page-1}&search=${l}`,preserveState:!0,children:e.jsx(j,{})}):e.jsx("div",{className:"text-gray-300",children:e.jsx(j,{})}),pageAfter:s.links[s.links.length-1].url?e.jsx(r,{href:`/admin/users?page=${s.current_page+1}&search=${l}`,only:["users"],preserveState:!0,children:e.jsx(p,{})}):e.jsx("div",{className:"text-gray-300",children:e.jsx(p,{})}),page:e.jsxs(e.Fragment,{children:[s.current_page,"/",s.last_page]}),data:s,hasDate:!0,dateValue:d,onChangeDate:S,showFilter:()=>c(!0)}),e.jsx(re,{children:x.map(a=>e.jsxs("div",{className:" text-gray-900 py-2 px-1 border flex justify-between",children:[e.jsxs("div",{className:"",children:[e.jsx("div",{children:a.email}),e.jsx("div",{className:"text-sm",children:a.name}),e.jsxs("div",{className:"text-sm",children:["Dibuat Tanggal: ",a.date]}),e.jsx("div",{className:"text-sm",children:a.email_verified_at?e.jsx("div",{className:"italic text-green-600",children:"Telah Terverifikasi"}):e.jsx("div",{className:"italic text-red-600",children:"Belum Terverifikasi"})})]}),e.jsx("div",{children:a.role.toUpperCase()})]},a.id))}),e.jsxs(ce,{children:[e.jsxs(ie,{children:[e.jsx("button",{className:"py-2 px-3 border rounded-lg",onClick:()=>c(!0),children:e.jsx(Z,{})}),e.jsx("div",{className:"w-1/4 my-auto ",children:e.jsx(q,{value:d,onChange:S,showShortcuts:!0,classNames:"border-2",separator:" sampai "})}),e.jsxs("div",{className:"w-1/4 border flex rounded-lg",children:[e.jsx("label",{htmlFor:"search-input",className:"my-auto ml-2",children:e.jsx(ee,{})}),e.jsx("input",{id:"search-input",name:"search-input",type:"search",placeholder:"Cari Pengguna",className:"w-full border-none focus:outline-none focus:ring-0",value:l||"",onChange:a=>C(a.target.value)})]}),e.jsxs("div",{className:"italic text-xs my-auto w-1/12 text-center",children:[N(s.current_page*s.per_page-(s.per_page-1)),"-",N(s.to)," dari ",N(s.total)]}),e.jsxs("div",{className:"my-auto flex space-x-2 w-1/12",children:[e.jsx("div",{className:"my-auto",children:s.links[0].url?e.jsx(r,{href:`/admin/users?page=${s.current_page-1}&search=${l}`,preserveState:!0,children:e.jsx(j,{})}):e.jsx("div",{className:"text-gray-300",children:e.jsx(j,{})})}),e.jsxs("div",{className:"my-auto",children:[s.current_page,"/",s.last_page]}),e.jsx("div",{className:"my-auto",children:s.links[s.links.length-1].url?e.jsx(r,{href:`/admin/users?page=${s.current_page+1}&search=${l}`,only:["users","userCollections"],preserveState:!0,children:e.jsx(p,{})}):e.jsx("div",{className:"text-gray-300",children:e.jsx(p,{})})})]})]}),e.jsx(ne,{children:e.jsxs("table",{className:"table table-pin-rows table-pin-cols text-base",children:[e.jsx("thead",{className:"text-base text-gray-900",children:e.jsxs("tr",{className:"",children:[e.jsx("th",{className:"bg-gray-200",children:"Nama"}),e.jsx("th",{className:"bg-gray-200",children:"Email"}),e.jsx("th",{className:"bg-gray-200",children:"Dibuat Tanggal"}),e.jsx("th",{className:"bg-gray-200",children:"Verifikasi"}),e.jsx("th",{className:"bg-gray-200",children:"Afiliasi"}),e.jsx("th",{className:"bg-gray-200"})]})}),e.jsx("tbody",{className:"",children:x.map((a,o)=>e.jsxs("tr",{className:`${o%2==0&&"bg-gray-100"}`,children:[e.jsx("td",{className:"",children:a.name}),e.jsx("td",{className:"",children:a.email}),e.jsx("td",{className:"",children:a.date}),e.jsx("td",{className:"",children:a.email_verified_at?e.jsx("div",{className:"italic text-green-600",children:"Telah Terverifikasi"}):e.jsx("div",{className:"italic text-red-600",children:"Belum Terverifikasi"})}),e.jsx("td",{className:"",children:a.affiliation}),e.jsx("td",{className:"text-end",children:!a.affiliation&&e.jsxs("div",{className:"dropdown dropdown-left",children:[e.jsx("div",{tabIndex:0,role:"button",className:"bg-inherit border-none hover:bg-gray-100 -z-50 text-gray-300'",children:e.jsx(ae,{})}),e.jsx("ul",{tabIndex:0,className:"dropdown-content z-[50] menu p-2 shadow bg-base-100 rounded-box w-56",children:e.jsx("li",{children:e.jsxs("button",{onClick:()=>H(a),children:[e.jsx(de,{}),"Afiliasi"]})})})]})})]},o))})]})})]}),e.jsx(I,{show:M,onClose:()=>h(!1),children:e.jsx("form",{onSubmit:L,children:e.jsxs("div",{className:"p-5",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Buat Affiliasi"}),e.jsxs("section",{className:"mt-5 space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-1",children:[e.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:e.jsx(v,{value:"Nama",htmlFor:"name",className:" mx-auto my-auto"})}),e.jsxs("div",{className:"w-full sm:w-2/3",children:[e.jsx(b,{id:"name",name:"name",className:`w-full ${(t==null?void 0:t.name)&&"border-red-500"}`,isFocused:!0,placeholder:"Nama",value:n.name,onChange:a=>f("name",a.target.value.toUpperCase())}),(t==null?void 0:t.name)&&e.jsx("span",{className:"text-red-500 text-xs",children:t.name})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-1",children:[e.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:e.jsx(v,{value:"Kode",htmlFor:"no_ref",className:" mx-auto my-auto"})}),e.jsxs("div",{className:"w-full sm:w-2/3",children:[e.jsx(b,{id:"no_ref",name:"no_ref",className:`w-full ${(t==null?void 0:t.no_ref)&&"border-red-500"}`,placeholder:"Kode",value:n.no_ref,onChange:a=>f("no_ref",a.target.value.toUpperCase())}),(t==null?void 0:t.no_ref)&&e.jsx("span",{className:"text-red-500 text-xs",children:t.no_ref})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-1",children:[e.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:e.jsx(v,{value:"Insenstive (%)",htmlFor:"insentive",className:" mx-auto my-auto"})}),e.jsxs("div",{className:"w-full sm:w-2/3",children:[e.jsx(b,{id:"insentive",name:"insentive",className:`w-full ${(t==null?void 0:t.insentive)&&"border-red-500"}`,placeholder:"Kode",value:n.insentive,onChange:a=>f("insentive",parseInt(a.target.value))}),(t==null?void 0:t.insentive)&&e.jsx("span",{className:"text-red-500 text-xs",children:t.insentive})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(A,{onClick:()=>h(!1),children:"Batal"}),e.jsx(T,{className:"ms-3",disabled:z,children:"Buat Afiliasi"})]})]})})}),e.jsx(I,{show:$,onClose:()=>c(!1),children:e.jsx("form",{onSubmit:O,children:e.jsxs("div",{className:"p-5",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Filter"}),e.jsx("section",{className:"mt-5 space-y-2",children:e.jsx("div",{className:"form-control w-1/6",children:e.jsxs("label",{className:"label cursor-pointer gap-2",htmlFor:"affiliation",children:[e.jsx("input",{type:"checkbox",className:"checkbox",id:"affiliation",value:u,onChange:()=>K(!u),checked:u}),e.jsx("span",{className:"label-text font-bold",children:"Afiliasi"})]})})}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(A,{onClick:()=>c(!1),children:"Batal"}),e.jsx(T,{className:"ms-3",children:"Filter"})]})]})})})]})}me.layout=s=>e.jsx(J,{header:e.jsx(X,{children:"Data Pengguna"}),children:s,user:s.props.auth.user,title:"Data Pengguna",backLink:e.jsx(r,{href:route("admin.user-master"),children:e.jsx(se,{})}),breadcrumbs:e.jsx("div",{className:"text-sm breadcrumbs",children:e.jsxs("ul",{children:[e.jsx("li",{className:"font-bold",children:e.jsx(r,{href:route("admin.user-master"),children:"Data Master Pengguna"})}),e.jsx("li",{children:"Data Pengguna"})]})})});export{me as default};
