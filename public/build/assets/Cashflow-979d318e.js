import{r as s,j as e,Y as Ne,y as ye,a as q}from"./app-f39f5256.js";import{D as G,A as we}from"./AuthenticatedLayout-e2125e6a.js";import{H as be}from"./Header-39ce6dc8.js";import{s as K,t as De,c as Ce}from"./index.esm-1a465fb0.js";import{S as Se}from"./SecondaryButton-12c497fc.js";import{d as J}from"./index.esm-1a801f03.js";import{P as Ye}from"./PrimaryButton-e7612656.js";import{f as F}from"./formatNumber-b542c689.js";import L from"./CashflowContent-1f4aa0a0.js";import{d as u}from"./dayjs.min-2681d619.js";import{I as R}from"./InputLabel-4d406470.js";import{C as T}from"./ClientSelectInput-47bc114d.js";import{j as B}from"./disclosure-f2ee139a.js";import{z as ke}from"./transition-4036d903.js";import"./ApplicationLogo-dae171ed.js";import"./iconBase-62f121b1.js";/* empty css                      */import"./combobox-761de6bb.js";import"./portal-ca4f363a.js";import"./close-provider-e51f726a.js";function Me({organization:r,cashflows:D,startDateFilter:C,endDateFilter:S,startCashflow:O,projects:f,programs:j,departments:v,project:c,program:m,department:x}){const[Y,Q]=s.useState(D||[]),[p,W]=s.useState(C||""),[h,X]=s.useState(S||""),[o,Z]=s.useState({accountCode:!1}),[k,ee]=s.useState({add:0,reduce:0}),[M,te]=s.useState({add:0,reduce:0}),[P,se]=s.useState({add:0,reduce:0}),[g,H]=s.useState({before:O.total||0,increase:0,after:0}),[ae,re]=s.useState({startDate:C||"",endDate:C||""}),[le,ne]=s.useState({startDate:S||"",endDate:S||""}),[I,A]=s.useState({financing:!1,operating:!1,investing:!1}),[de,N]=s.useState(!1),[l,V]=s.useState({id:c?c.id:null,name:c?c.name:"",code:c?c.code:""}),[ie,Pe]=s.useState(""),[n,U]=s.useState({id:m?m.id:null,name:m?m.name:"",code:m?m.code:""}),[oe,Ie]=s.useState(""),[d,$]=s.useState({id:x?x.id:null,name:x?x.name:"",code:x?x.code:""}),[ce,Ae]=s.useState("");s.useEffect(()=>{z(D,O)},[]);const me=t=>{U(t)},xe=()=>{U({id:null,name:"",code:""})},ue=t=>{V(t)},pe=()=>{V({id:null,name:"",code:""})},he=t=>{$(t)},fe=()=>{$({id:null,name:"",code:""})},z=(t,i)=>{let y={add:0,reduce:0},w={add:0,reduce:0},b={add:0,reduce:0},E=0;t.map(a=>{E+=parseInt(a.total),a.category=="operating"&&(A({...I,operating:!0}),parseInt(a.total)>0&&(y.add+=parseInt(a.total)),parseInt(a.total)<0&&(y.reduce+=parseInt(a.total))),a.category=="financing"&&(A({...I,financing:!0}),parseInt(a.total)>0&&(w.add+=parseInt(a.total)),parseInt(a.total)<0&&(w.reduce+=parseInt(a.total))),a.category=="investing"&&(A({...I,investing:!0}),parseInt(a.total)>0&&(b.add+=parseInt(a.total)),parseInt(a.total)<0&&(b.reduce+=parseInt(a.total)))}),ee({add:y.add,reduce:y.reduce}),se({add:b.add,reduce:b.reduce}),te({add:w.add,reduce:w.reduce}),H({before:parseInt(i.total??0),increase:E,after:parseInt(i.total??0)+E})},_=()=>{window.print()},je=t=>{re(t),W(u(t.endDate).format("YYYY-MM-DD"))},ve=t=>{ne(t),X(u(t.endDate).format("YYYY-MM-DD"))},ge=()=>{ye.reload({only:["cashflows","startCashflow"],data:{startDate:p,endDate:h,program:n.id,project:l.id,department:d.id},onBefore:t=>{t.completed?N(!1):N(!0)},onSuccess:t=>{Q(t.props.cashflows),H({...g,before:t.props.startCashflow.total}),z(t.props.cashflows,t.props.startCashflow)},onError:t=>{console.log(t)},onFinish:t=>{t.completed?N(!1):N(!0)},preserveState:!0})};return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{title:`Laporan Arus Kas Periode : ${u(p).format("MMMM DD, YYYY")} - ${u(h).format("MMMM DD, YYYY")}`}),e.jsx("div",{className:"sm:pt-0 pb-16 pt-12",children:e.jsxs("div",{className:"bg-white py-2 sm:pt-0 px-5",children:[e.jsxs("div",{className:"flex sm:flex-row justify-between gap-2 print:hidden",children:[e.jsxs("div",{className:"px-3 my-auto flex gap-3",children:[e.jsx("div",{className:"my-auto",children:e.jsx(G,{value:ae,onChange:je,useRange:!1,asSingle:!0,placeholder:"Tanggal Awal",id:"date",displayFormat:"MMMM DD, YYYY"})}),e.jsx("div",{className:"my-auto",children:e.jsx(G,{value:le,onChange:ve,useRange:!1,asSingle:!0,placeholder:"Tanggal Akhir",id:"date",displayFormat:"MMMM DD, YYYY"})}),e.jsx("div",{className:"my-auto",children:e.jsx(Ye,{disabled:!p||!h||p>h||de,onClick:ge,children:"Filter"})})]}),e.jsx("div",{className:"text-end px-3 hidden sm:block",children:e.jsx(Se,{onClick:_,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"my-auto",children:e.jsx(J,{})}),e.jsx("div",{className:"my-auto",children:"Print"})]})})}),e.jsx("div",{className:"fixed sm:hidden bottom-2 right-2",children:e.jsx("button",{onClick:_,className:"bg-white border-2 border-slate-900 p-2 rounded-full h-14 w-14",children:e.jsx("div",{className:"flex gap-2",children:e.jsx("div",{className:"my-auto mx-auto",children:e.jsx(J,{})})})})})]}),e.jsx(B,{as:"div",className:"mt-3 print:hidden",children:({open:t})=>e.jsxs(e.Fragment,{children:[e.jsx(ke,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsxs(B.Panel,{children:[j.length>0||f.length>0||v.length?e.jsxs("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:[j.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(R,{value:"Program Kegiatan",htmlFor:"program"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(T,{resources:j,selected:n,setSelected:i=>me(i),maxHeight:"max-h-40",placeholder:"Cari Program Kegiatan",isError:!!oe,id:"program"}),n.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",n.code]})]}),n.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:xe,children:e.jsx(K,{})})})]})]}),f.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(R,{value:"Proyek",htmlFor:"project"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(T,{resources:f,selected:l,setSelected:i=>ue(i),maxHeight:"max-h-40",placeholder:"Cari Proyek",isError:!!ie,id:"project"}),l.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",l.code]})]}),l.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:pe,children:e.jsx(K,{})})})]})]}),v.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(R,{value:"Departemen",htmlFor:"department"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(T,{resources:v,selected:d,setSelected:i=>he(i),maxHeight:"max-h-40",placeholder:"Cari Departemen",isError:!!ce,id:"department"}),d.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",d.code]})]}),d.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:fe,children:e.jsx(K,{})})})]})]})]}):"",e.jsx("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer gap-2",htmlFor:"checkbox",children:[e.jsx("input",{type:"checkbox",className:"checkbox",id:"checkbox",value:o.accountCode,onChange:()=>Z({...o.accountCode,accountCode:!o.accountCode}),checked:o.accountCode}),e.jsx("span",{className:"label-text",children:"Tampilkan Kode Akun"})]})})})]})}),e.jsx(B.Button,{className:"flex w-full justify-between rounded-lg bg-slate-100 px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-slate-500/75",children:e.jsxs("div",{className:"flex justify-center w-full gap-3",children:[e.jsx("span",{children:"Tampilkan Lebih Banyak"}),e.jsx(De,{className:`${t?"":"rotate-180 transform"} h-5 w-5 text-slate-500`})]})})]})}),e.jsxs("div",{className:"uppercase pt-9 pb-3 border-b hidden print:flex print:justify-between",children:[e.jsx("div",{className:"w-1/2 text-2xl my-auto",children:"Laporan arus kas"}),e.jsxs("div",{className:"w-1/2 text-end mt-auto",children:[e.jsx("div",{children:r.name}),e.jsx("div",{className:"text-xs",children:r.address}),e.jsxs("div",{className:"text-xs",children:[r.village,", ",r.district,", ",r.regency,","," ",r.province]})]})]}),e.jsxs("div",{className:"w-full mt-3 hidden print:flex print:justify-between",children:[e.jsxs("div",{className:"text-end italic ",children:["Periode : ",u(p).format("MMMM DD, YYYY")," -"," ",u(h).format("MMMM DD, YYYY")]}),e.jsx("div",{className:"text-xs my-auto",children:j.length>0||f.length>0||v.length>0?e.jsxs("div",{children:[n.name&&e.jsxs("div",{children:["Program Kegiatan: ",n.code,"-",n.name.toUpperCase()]}),l.name&&e.jsxs("div",{children:["Proyek : ",l.code,"-",l.name.toUpperCase()]}),d.name&&e.jsxs("div",{children:["Departemen : ",d.code,"-",d.name.toUpperCase()]})]}):""})]}),e.jsx("div",{className:"my-2 space-y-3 mx-3 print:font-['Open_Sans'] overflow-auto",children:e.jsxs("div",{className:"sm:w-3/4 w-[550px] print:w-full",children:[k.add+k.reduce!==0&&e.jsx(L,{title:"Aktifitas Operasional",cashflows:Y,amount:k,type:"operating",showCode:o.accountCode}),P.add+P.reduce!==0&&e.jsx(L,{title:"Aktifitas Investasi",cashflows:Y,amount:P,type:"investing",showCode:o.accountCode}),M.add+M.reduce!==0&&e.jsx(L,{title:"Aktifitas Pendanaan",cashflows:Y,amount:M,type:"financing",showCode:o.accountCode}),D.length>0&&e.jsxs("div",{className:"mt-5",children:[e.jsxs("div",{className:"flex w-full justify-between py-2 font-bold",children:[e.jsx("div",{className:"w-5/12 print:w-8/12 uppercase flex gap-2",children:"Kas Awal"}),e.jsxs("div",{className:"w-2/12 print:w-4/12 text-center flex justify-end gap-3",children:[e.jsx("div",{className:"w-1/4 print:w-2/4 text-end",children:"Rp. "}),e.jsx("div",{className:"w-3/4 print:w-2/4 text-end",children:F(g.before)})]})]}),e.jsxs("div",{className:"flex w-full justify-between py-2 font-bold",children:[e.jsx("div",{className:"w-5/12 print:w-8/12 uppercase flex gap-2",children:"Kenaikan / Penurunan Kas"}),e.jsxs("div",{className:"w-2/12 print:w-4/12 text-center flex justify-end gap-3",children:[e.jsx("div",{className:"w-1/4 print:w-2/4 text-end",children:"Rp. "}),e.jsx("div",{className:"w-3/4 print:w-2/4 text-end",children:F(g.increase)})]})]}),e.jsxs("div",{className:"flex w-full justify-between py-2 font-bold",children:[e.jsx("div",{className:"w-5/12 print:w-8/12 uppercase flex gap-2",children:"Kas Akhir"}),e.jsxs("div",{className:"w-2/12 print:w-4/12 text-center flex justify-end gap-3",children:[e.jsx("div",{className:"w-1/4 print:w-2/4 text-end",children:"Rp. "}),e.jsx("div",{className:"w-3/4 print:w-2/4 text-end",children:F(g.after)})]})]})]})]})})]})})]})}Me.layout=r=>e.jsx(we,{header:e.jsx(be,{children:"Laporan Arus Kas"}),children:r,user:r.props.auth.user,organization:r.props.organization,title:"Laporan Arus Kas",backLink:e.jsx(q,{href:route("report",r.props.organization.id),children:e.jsx(Ce,{})}),breadcrumbs:e.jsx("div",{className:"text-sm breadcrumbs",children:e.jsxs("ul",{children:[e.jsx("li",{className:"font-bold",children:e.jsx(q,{href:route("report",r.props.organization.id),children:"Laporan"})}),e.jsx("li",{children:"Laporan Arus Kas"})]})}),role:r.props.role});export{Me as default};
