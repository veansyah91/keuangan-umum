import{r as c,W as ue,y as xe,j as e,Y as pe,a as i}from"./app-68378a75.js";import{D as he,A as je}from"./AuthenticatedLayout-aa84864c.js";import{H as fe}from"./Header-d9b20899.js";import{o as w,r as ve,k as Ne,c as we}from"./index.esm-023a1d14.js";import{S as ge}from"./SecondaryButton-40901484.js";import{P as be}from"./PrimaryButton-98341e8c.js";import{F as ye}from"./FormInput-ccad4945.js";import{k as _e,Q as P}from"./react-toastify.esm-f59b1f4b.js";import{I as n}from"./InputLabel-8493eb3f.js";import{T as k}from"./TextInput-3adfab26.js";import{o as Se,u as De}from"./index.module-29cbd6cc.js";import{N as ke}from"./react-number-format.es-c1c58463.js";import{C as j}from"./ClientSelectInput-e0070ca8.js";import{C as Ce}from"./ContactSelectInput-568742b2.js";import{f as Ae}from"./formatNumber-b542c689.js";import{d as g}from"./dayjs.min-c779e003.js";import{$ as C}from"./disclosure-9425a19a.js";import{X as Ee}from"./transition-a4e373a4.js";import"./ApplicationLogo-10150e9c.js";import"./iconBase-f8c3c84d.js";/* empty css                      */import"./combobox-f9799b5e.js";import"./portal-ab6e9e20.js";import"./close-provider-c8aabbb8.js";function Fe({cashIn:a,organization:p,newRef:Ke,date:Pe,accounts:B,cashAccounts:T,projects:b,programs:y,departments:_,contacts:M}){const[m,S]=c.useState(a.selectedAccount),[Y,R]=c.useState({id:a.contact.id,name:a.contact.name,phone:a.contact.phone});c.useState("");const[h,O]=c.useState(a.cashAccount),[Be,U]=c.useState(""),[D,A]=c.useState(["",""]),[f,E]=c.useState({id:a.journal.project_id,name:a.journal.project_id?a.journal.project.name:"",code:a.journal.project_id?a.journal.project.codes:""}),[$,Te]=c.useState(""),[v,F]=c.useState({id:a.journal.program_id,name:a.journal.program_id?a.journal.program.name:"",code:a.journal.program_id?a.journal.program.codes:""}),[H,Me]=c.useState(""),[N,K]=c.useState({id:a.journal.department_id,name:a.journal.department_id?a.journal.department.name:"",code:a.journal.department_id?a.journal.department.codes:""}),[V,Ye]=c.useState(""),[u,z]=c.useState({startDate:a.date,endDate:a.date}),[L,X]=c.useState(0),{data:d,setData:r,patch:Q,reset:Re,errors:x,setError:Oe,processing:W}=ue({date:a.date,contact_id:a.contact_id,no_ref:a.no_ref,description:a.description,program_id:a.journal.program_id,project_id:a.journal.project_id,department_id:a.journal.department_id,is_approved:a.journal.is_approved,cash_account_id:a.cashAccount.id,accounts:a.accounts}),[q]=Se(u,500),G=De(u);c.useEffect(()=>{if(G!==void 0&&u.startDate){let t=g(u.startDate),s=`${t.month()+1}-${t.year()}`,l=g(a.date),o=`${l.month()+1}-${l.year()}`;s!==o?Z():r("no_ref",a.no_ref)}},[q]),c.useEffect(()=>{let t=d.accounts.reduce((s,l)=>s+l.value,0);X(t)},[d]);const J=t=>{t.preventDefault(),Q(route("cashflow.cash-in.update",{organization:p.id,cashIn:a.id}),{onSuccess:s=>{P.success("Kas Masuk Berhasil Diubah",{position:P.POSITION.TOP_CENTER})},onError:s=>{U(s.cash_account_id)}})},Z=()=>{xe.reload({only:["newRef"],data:{date:g(u.startDate).format("YYYY-MM-DD")},onSuccess:t=>{r("no_ref",t.props.newRef)}})},I=t=>{R({id:t.id,name:t.name,phone:t.phone});let s=d;s={...s,contact_id:t.id,description:`Kas Masuk dari ${t.name.toUpperCase()}`},r(s)},ee=t=>{O({id:t.id,name:t.name,code:t.code,is_cash:!0}),r("cash_account_id",t.id)},te=(t,s)=>{const l=[...m],o=[...d.accounts];l[s]=t,o[s]={...o[s],id:t.id,name:t.name,code:t.code,is_cash:t.is_cash},S(l),r("accounts",o)},ae=(t,s)=>{const{value:l}=t,o=[...d.accounts];o[s]={...o[s],value:parseInt(l)},r("accounts",o)},se=t=>{z(t),r("date",g(t.startDate).format("YYYY-MM-DD"))},le=()=>{const t=[...d.accounts,{id:null,name:"",code:"",value:0,is_cash:!1}];r("accounts",t);const s=[...m,{id:null,name:"",code:"",is_cash:!1}];S(s);let l=[...D];l=[...l,""],A(l)},re=t=>{const s=[...d.accounts];s.splice(t,1),r("accounts",s);const l=[...m];l.splice(t,1),S(l);let o=[...D];o.splice(t,1),A(o)},oe=t=>{F(t),r("program_id",t.id)},ce=()=>{F({id:null,name:"",code:""}),r("program_id",null)},de=t=>{E(t),r("project_id",t.id)},ne=()=>{E({id:null,name:"",code:""}),r("project_id",null)},ie=t=>{K(t),r("department_id",t.id)},me=()=>{K({id:null,name:"",code:""}),r("department_id",null)};return e.jsxs(e.Fragment,{children:[e.jsx(pe,{title:"Ubah Kas Masuk"}),e.jsx(_e,{}),e.jsx(ye,{onSubmit:J,children:e.jsx("div",{className:"w-full sm:mt-2 sm:py-5",children:e.jsxs("div",{className:"sm:mx-auto px-3 sm:px-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(n,{value:"Nama Kontak",htmlFor:"contact"})}),e.jsx("div",{children:e.jsx(Ce,{resources:M,selected:Y,setSelected:t=>I(t),maxHeight:"max-h-40",placeholder:"Cari Kontak",isError:!!x.contact_id,id:"contact",notFound:e.jsxs("span",{children:["Tidak Ada Data. ",e.jsx(i,{className:"font-bold text-blue-600",href:route("data-master.contact.create",{organization:p.id}),children:"Buat Baru ?"})]})})})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(n,{value:"Ke Akun Kas",htmlFor:"cash_account"})}),e.jsxs("div",{children:[e.jsx(j,{resources:T,selected:h,setSelected:t=>ee(t),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!x.cash_account_id,id:"cash_account",notFound:e.jsxs("span",{children:["Tidak Ada Data. ",e.jsx(i,{className:"font-bold text-blue-600",href:route("data-ledger.account",{organization:p.id}),children:"Buat Baru ?"})]})}),(h==null?void 0:h.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",h.code]})]})]}),e.jsx("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 mt-7",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(n,{value:"Tanggal"})}),e.jsx("div",{children:e.jsx(he,{value:u,onChange:se,inputClassName:(x==null?void 0:x.date)&&"border-red-500 rounded-lg",useRange:!1,asSingle:!0,placeholder:"Tanggal",id:"date",displayFormat:"MMMM DD, YYYY"})})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(n,{value:"No. Ref",htmlFor:"no_ref"})}),e.jsx("div",{children:e.jsx(k,{id:"no_ref",className:`w-full ${x.no_ref&&"border-red-500"}`,value:d.no_ref,onChange:t=>r("no_ref",t.target.value)})})]}),e.jsxs("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(n,{value:"Deskripsi",htmlFor:"description"})}),e.jsx("div",{children:e.jsx(k,{id:"description",className:"w-full",value:d.description,onChange:t=>r("description",t.target.value)})})]})]}),(b.length>0||y.length>0||_.length>0)&&e.jsx("div",{className:"mt-3",children:e.jsx(C,{children:({open:t})=>e.jsxs(e.Fragment,{children:[e.jsx(Ee,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsx(C.Panel,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:[y.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(n,{value:"Program Kegiatan",htmlFor:"program"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(j,{resources:y,selected:v,setSelected:s=>oe(s),maxHeight:"max-h-40",placeholder:"Cari Program Kegiatan",isError:!!H,id:"program"}),v.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",v.code]})]}),v.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:ce,children:e.jsx(w,{})})})]})]}),b.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(n,{value:"Proyek",htmlFor:"project"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(j,{resources:b,selected:f,setSelected:s=>de(s),maxHeight:"max-h-40",placeholder:"Cari Proyek",isError:!!$,id:"project"}),f.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",f.code]})]}),f.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:ne,children:e.jsx(w,{})})})]})]}),_.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(n,{value:"Departemen",htmlFor:"department"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(j,{resources:_,selected:N,setSelected:s=>ie(s),maxHeight:"max-h-40",placeholder:"Cari Departemen",isError:!!V,id:"department"}),N.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",N.code]})]}),N.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:me,children:e.jsx(w,{})})})]})]})]})})}),e.jsx(C.Button,{className:"flex w-full justify-between rounded-lg bg-slate-100 px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-slate-500/75",children:e.jsxs("div",{className:"flex justify-center w-full gap-3",children:[e.jsxs("span",{children:["Tampilkan Lebih ",t?"Sedikit":"Banyak"]}),e.jsx(ve,{className:`${t?"":"rotate-180 transform"} h-5 w-5 text-slate-500`})]})})]})})}),e.jsx("div",{className:"mt-5",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"md:flex font-bold gap-3 border-b py-3 hidden",children:[e.jsx("div",{className:"w-5/12",children:"AKUN"}),e.jsx("div",{className:"w-3/12 text-end"}),e.jsx("div",{className:"w-3/12 text-end",children:"NILAI"}),e.jsx("div",{className:"w-1/12 text-center",children:"#"})]}),d.accounts.map((t,s)=>{var l;return e.jsxs("div",{className:"md:flex gap-3 py-3 mt-2 space-y-2 border md:border-none rounded-lg border-slate-900 px-3",children:[e.jsxs("div",{className:"md:hidden text-slate-800",children:["Baris : ",s+1]}),e.jsxs("div",{className:"md:w-5/12 w-full relative",children:[e.jsx(j,{resources:B,selected:m[s],setSelected:o=>te(o,s),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!D[s],notFound:e.jsxs("span",{children:["Tidak Ada Data. ",e.jsx(i,{className:"font-bold text-blue-600",href:route("data-ledger.account",{organization:p.id}),children:"Buat Baru ?"})]})}),((l=m[s])==null?void 0:l.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",m[s].code]})]}),e.jsx("div",{className:"md:w-3/12 w-full text-end my-auto"}),e.jsx("div",{className:"md:w-3/12 w-full text-end my-auto",children:e.jsx(ke,{value:t.value,customInput:k,onValueChange:o=>ae(o,s),thousandSeparator:!0,className:"text-end w-full",prefix:"IDR "})}),e.jsx("div",{className:"md:w-1/12 w-full text-center my-auto",children:e.jsx("button",{type:"button",className:"md:text-red-500 text-white bg-red-500 md:bg-white text-xl hover:bg-slate-200 rounded-full p-2 w-full",onClick:()=>re(s),children:e.jsx("div",{className:"text-center",children:e.jsx(w,{className:"text-center w-full"})})})})]},s)}),e.jsx("div",{className:"py-3 mt-4",children:e.jsxs("button",{className:"w-full border bg-slate-100 hover:bg-slate-200 text-slate-500 py-3 flex justify-center gap-2",type:"button",onClick:le,children:[e.jsx("div",{className:"my-auto",children:e.jsx(Ne,{})}),e.jsx("div",{children:"Ubah Baris Baru"})]})})]})}),e.jsxs("div",{className:"md:flex font-bold gap-3",children:[e.jsx("div",{className:"w-5/12"}),e.jsxs("div",{className:"md:w-7/12 flex border-t py-3 gap-12 px-3",children:[e.jsx("div",{className:"w-1/2",children:"TOTAL "}),e.jsxs("div",{className:"w-1/2 text-end",children:["IDR ",Ae(L)]})]})]}),e.jsxs("div",{className:"md:flex font-bold gap-3",children:[e.jsx("div",{className:"w-5/12"}),e.jsx("div",{className:"md:w-7/12 flex border-t py-3 gap-2 px-3",children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer gap-2",htmlFor:"checkbox",children:[e.jsx("input",{type:"checkbox",className:"checkbox",id:"checkbox",value:!d.is_approved,onChange:()=>r("is_approved",!d.is_approved),checked:!d.is_approved}),e.jsx("span",{className:"label-text",children:"Simpan Ke Dalam Draft"})]})})})]}),e.jsxs("div",{className:"flex justify-end flex-col-reverse sm:flex-row gap-2 mt-5",children:[e.jsx("div",{className:"w-full sm:w-1/12 my-auto text-center",children:e.jsx(i,{href:route("cashflow.cash-in",p.id),children:e.jsx(ge,{className:"w-full",children:e.jsx("div",{className:"text-center w-full",children:"Batal"})})})}),e.jsx("div",{className:"w-full sm:w-1/12 text-center",children:e.jsx(be,{className:"w-full",disabled:W,children:e.jsx("div",{className:"text-center w-full",children:"Ubah"})})})]})]})})})]})}Fe.layout=a=>e.jsx(je,{header:e.jsx(fe,{children:"Ubah Kas Masuk"}),children:a,user:a.props.auth.user,organization:a.props.organization,title:"Ubah Kas Masuk",backLink:e.jsx(i,{href:route("cashflow.cash-in",a.props.organization.id),children:e.jsx(we,{})}),breadcrumbs:e.jsx("div",{className:"text-sm breadcrumbs",children:e.jsxs("ul",{children:[e.jsx("li",{className:"font-bold",children:e.jsx(i,{href:route("cashflow",a.props.organization.id),children:"Arus Kas"})}),e.jsx("li",{className:"font-bold",children:e.jsx(i,{href:route("cashflow.cash-in",a.props.organization.id),children:"Kas Masuk"})}),e.jsx("li",{children:"Ubah Kas Masuk"})]})}),role:a.props.role});export{Fe as default};
