import{r as c,m as fe,S as ve,j as e,L as Ne,$ as i}from"./app-8a73958f.js";import{D as be,A as we}from"./AuthenticatedLayout-a6d205fd.js";import{H as ge}from"./Header-4c3a0c52.js";import{t as y,u as ye,m as Se,c as _e}from"./index.esm-72e46d09.js";import{S as De}from"./SecondaryButton-7a90be04.js";import{P as ke}from"./PrimaryButton-05ccabb6.js";import{F as Ce}from"./FormInput-539a4f7a.js";import{k as Ke,Q as R}from"./react-toastify.esm-61ed81a8.js";import{I as d}from"./InputLabel-92af91a1.js";import{T}from"./TextInput-759be9ea.js";import{a as Ae,u as Ee}from"./index.module-6a1fc176.js";import{N as Te}from"./react-number-format.es-7747aab2.js";import{C as j}from"./ClientSelectInput-0272f5a9.js";import{C as Pe}from"./ContactSelectInput-920bdcfd.js";import{f as Fe}from"./formatNumber-b542c689.js";import{d as H}from"./dayjs.min-f50edeaa.js";import{j as P}from"./disclosure-4238bd82.js";import{z as Ie}from"./transition-c189f5cc.js";import"./ApplicationLogo-da93ba3b.js";import"./iconBase-0306a48d.js";/* empty css                      */import"./combobox-b4eefbb9.js";import"./portal-a306a85f.js";import"./close-provider-6c68c085.js";function Be({organization:n,newRef:M,date:S,accounts:V,cashAccounts:L,projects:_,programs:D,departments:k,contacts:z}){const[u,f]=c.useState([{id:null,name:"",code:""}]),[$,F]=c.useState({id:null,name:"",phone:""});c.useState("");const[x,I]=c.useState({id:null,name:"",code:"",is_cash:!0}),[Ye,U]=c.useState(""),[v,C]=c.useState(["",""]),[N,K]=c.useState({id:null,name:"",code:""}),[q,Oe]=c.useState(""),[b,A]=c.useState({id:null,name:"",code:""}),[Q,Re]=c.useState(""),[w,E]=c.useState({id:null,name:"",code:""}),[G,He]=c.useState(""),[h,B]=c.useState({startDate:S,endDate:S}),[Y,J]=c.useState(0),{data:o,setData:t,post:W,reset:Me,errors:m,setError:Ve,processing:X}=fe({date:S,contact_id:null,no_ref:M,description:"Kas Keluar",program_id:null,project_id:null,department_id:null,is_approved:!0,cash_account_id:null,accounts:[{id:null,name:"",code:"",value:0,is_cash:!1}]}),[Z]=Ae(h,500),ee=Ee(h);c.useEffect(()=>{ee!==void 0&&h.startDate&&te()},[Z]),c.useEffect(()=>{let s=o.accounts.reduce((a,l)=>a+l.value,0);J(s)},[o]);const se=s=>{s.preventDefault(),W(route("cashflow.cash-out.post",n.id),{onSuccess:a=>{ae(a.props),R.success("Kas Keluar Berhasil Ditambahkan",{position:R.POSITION.TOP_CENTER})},onError:a=>{U(a.cash_account_id);const l=Object.entries(a).map(([p,g])=>({key:p,value:g}));let r=[];for(let p=0;p<v.length;p++){let g="";l.map(O=>{O.key.split(".").length===3&&O.key==`accounts.${p}.id`&&(g="required")}),r=[...r,g]}C(r)}})},ae=({newRef:s,date:a})=>{t({date:a,contact_id:null,no_ref:s,description:"Kas Keluar",program_id:null,project_id:null,department_id:null,is_approved:!0,cash_account_id:null,accounts:[{id:null,name:"",code:"",value:0,is_cash:!1}]}),B({startDate:a,endDate:a}),f([{id:null,name:"",code:""}]),F({id:null,name:"",phone:""}),I({id:null,name:"",code:"",is_cash:!0}),K({id:null,name:"",code:""}),A({id:null,name:"",code:""}),E({id:null,name:"",code:""})},te=()=>{ve.reload({only:["newRef"],data:{date:H(h.startDate).format("YYYY-MM-DD")},onSuccess:s=>{t("no_ref",s.props.newRef)}})},le=s=>{F({id:s.id,name:s.name,phone:s.phone});let a=o;a={...a,contact_id:s.id,description:`Kas Keluar kepada ${s.name.toUpperCase()}`},t(a)},re=s=>{I({id:s.id,name:s.name,code:s.code,is_cash:!0}),t("cash_account_id",s.id)},ce=(s,a)=>{const l=[...u],r=[...o.accounts];l[a]=s,r[a]={...r[a],id:s.id,name:s.name,code:s.code,is_cash:s.is_cash},f(l),t("accounts",r)},ne=(s,a)=>{const{value:l}=s,r=[...o.accounts];r[a]={...r[a],value:parseInt(l)},t("accounts",r)},oe=s=>{B(s),t("date",H(s.startDate).format("YYYY-MM-DD"))},de=()=>{const s=[...o.accounts,{id:null,name:"",code:"",value:0,is_cash:!1}];t("accounts",s);const a=[...u,{id:null,name:"",code:"",is_cash:!1}];f(a);let l=[...v];l=[...l,""],C(l)},ie=s=>{const a=[...o.accounts];a.splice(s,1),t("accounts",a);const l=[...u];l.splice(s,1),f(l);let r=[...v];r.splice(s,1),C(r)},ue=s=>{A(s),t("program_id",s.id)},me=()=>{A({id:null,name:"",code:""}),t("program_id",null)},xe=s=>{K(s),t("project_id",s.id)},he=()=>{K({id:null,name:"",code:""}),t("project_id",null)},pe=s=>{E(s),t("department_id",s.id)},je=()=>{E({id:null,name:"",code:""}),t("department_id",null)};return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{title:"Tambah Kas Keluar"}),e.jsx(Ke,{}),e.jsx(Ce,{onSubmit:se,children:e.jsx("div",{className:"w-full sm:mt-2 sm:py-5",children:e.jsxs("div",{className:"sm:mx-auto px-3 sm:px-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Nama Kontak",htmlFor:"contact"})}),e.jsx("div",{children:e.jsx(Pe,{resources:z,selected:$,setSelected:s=>le(s),maxHeight:"max-h-40",placeholder:"Cari Kontak",isError:!!m.contact_id,id:"contact",notFound:e.jsxs("span",{children:["Tidak Ada Data. ",e.jsx(i,{className:"font-bold text-blue-600",href:route("data-master.contact.create",{organization:n.id}),children:"Buat Baru ?"})]})})})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Dari Akun Kas",htmlFor:"cash_account"})}),e.jsxs("div",{children:[e.jsx(j,{resources:L,selected:x,setSelected:s=>re(s),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!m.cash_account_id,id:"cash_account",notFound:e.jsxs("span",{children:["Tidak Ada Data. ",e.jsx(i,{className:"font-bold text-blue-600",href:route("data-ledger.account",{organization:n.id}),children:"Buat Baru ?"})]})}),(x==null?void 0:x.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",x.code]})]})]}),e.jsx("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 mt-7",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Tanggal"})}),e.jsx("div",{children:e.jsx(be,{value:h,onChange:oe,inputClassName:(m==null?void 0:m.date)&&"border-red-500 rounded-lg",useRange:!1,asSingle:!0,placeholder:"Tanggal",id:"date",displayFormat:"MMMM DD, YYYY"})})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"No. Ref",htmlFor:"no_ref"})}),e.jsx("div",{children:e.jsx(T,{id:"no_ref",className:`w-full ${m.no_ref&&"border-red-500"}`,value:o.no_ref,onChange:s=>t("no_ref",s.target.value)})})]}),e.jsxs("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Deskripsi",htmlFor:"description"})}),e.jsx("div",{children:e.jsx(T,{id:"description",className:"w-full",value:o.description,onChange:s=>t("description",s.target.value)})})]})]}),(_.length>0||D.length>0||k.length>0)&&e.jsx("div",{className:"mt-3",children:e.jsx(P,{children:({open:s})=>e.jsxs(e.Fragment,{children:[e.jsx(Ie,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsx(P.Panel,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:[D.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Program Kegiatan",htmlFor:"program"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(j,{resources:D,selected:b,setSelected:a=>ue(a),maxHeight:"max-h-40",placeholder:"Cari Program Kegiatan",isError:!!Q,id:"program"}),b.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",b.code]})]}),b.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:me,children:e.jsx(y,{})})})]})]}),_.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Proyek",htmlFor:"project"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(j,{resources:_,selected:N,setSelected:a=>xe(a),maxHeight:"max-h-40",placeholder:"Cari Proyek",isError:!!q,id:"project"}),N.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",N.code]})]}),N.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:he,children:e.jsx(y,{})})})]})]}),k.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Departemen",htmlFor:"department"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(j,{resources:k,selected:w,setSelected:a=>pe(a),maxHeight:"max-h-40",placeholder:"Cari Departemen",isError:!!G,id:"department"}),w.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",w.code]})]}),w.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:je,children:e.jsx(y,{})})})]})]})]})})}),e.jsx(P.Button,{className:"flex w-full justify-between rounded-lg bg-slate-100 px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-slate-500/75",children:e.jsxs("div",{className:"flex justify-center w-full gap-3",children:[e.jsxs("span",{children:["Tampilkan Lebih ",s?"Sedikit":"Banyak"]}),e.jsx(ye,{className:`${s?"":"rotate-180 transform"} h-5 w-5 text-slate-500`})]})})]})})}),e.jsx("div",{className:"mt-5",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"md:flex font-bold gap-3 border-b py-3 hidden",children:[e.jsx("div",{className:"w-5/12",children:"AKUN"}),e.jsx("div",{className:"w-3/12 text-end"}),e.jsx("div",{className:"w-3/12 text-end",children:"NILAI"}),e.jsx("div",{className:"w-1/12 text-center",children:"#"})]}),o.accounts.map((s,a)=>{var l;return e.jsxs("div",{className:"md:flex gap-3 py-3 mt-2 space-y-2 border md:border-none rounded-lg border-slate-900 px-3",children:[e.jsxs("div",{className:"md:hidden text-slate-800",children:["Baris : ",a+1]}),e.jsxs("div",{className:"md:w-5/12 w-full relative",children:[e.jsx(j,{resources:V,selected:u[a],setSelected:r=>ce(r,a),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!v[a],notFound:e.jsxs("span",{children:["Tidak Ada Data. ",e.jsx(i,{className:"font-bold text-blue-600",href:route("data-ledger.account",{organization:n.id}),children:"Buat Baru ?"})]})}),((l=u[a])==null?void 0:l.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",u[a].code]})]}),e.jsx("div",{className:"md:w-3/12 w-full text-end my-auto"}),e.jsx("div",{className:"md:w-3/12 w-full text-end my-auto",children:e.jsx(Te,{value:s.value,customInput:T,onValueChange:r=>ne(r,a),thousandSeparator:!0,className:"text-end w-full border",prefix:"IDR "})}),e.jsx("div",{className:"md:w-1/12 w-full text-center my-auto",children:e.jsx("button",{type:"button",className:"md:text-red-500 text-white bg-red-500 md:bg-white text-xl hover:bg-slate-200 rounded-full p-2 w-full",onClick:()=>ie(a),children:e.jsx("div",{className:"text-center",children:e.jsx(y,{className:"text-center w-full"})})})})]},a)}),e.jsx("div",{className:"py-3 mt-4",children:e.jsxs("button",{className:"w-full border bg-slate-100 hover:bg-slate-200 text-slate-500 py-3 flex justify-center gap-2",type:"button",onClick:de,children:[e.jsx("div",{className:"my-auto",children:e.jsx(Se,{})}),e.jsx("div",{children:"Tambah Baris Baru"})]})})]})}),e.jsxs("div",{className:"md:flex font-bold gap-3",children:[e.jsx("div",{className:"w-5/12"}),e.jsxs("div",{className:"md:w-7/12 flex border-t py-3 gap-12 px-3",children:[e.jsx("div",{className:"w-1/2",children:"TOTAL "}),e.jsxs("div",{className:"w-1/2 text-end",children:["IDR ",Fe(Y)]})]})]}),e.jsxs("div",{className:"md:flex font-bold gap-3",children:[e.jsx("div",{className:"w-5/12"}),e.jsx("div",{className:"md:w-7/12 flex border-t py-3 gap-2 px-3",children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer gap-2",htmlFor:"checkbox",children:[e.jsx("input",{type:"checkbox",className:"checkbox",id:"checkbox",value:!o.is_approved,onChange:()=>t("is_approved",!o.is_approved),checked:!o.is_approved}),e.jsx("span",{className:"label-text",children:"Simpan Ke Dalam Draft"})]})})})]}),e.jsxs("div",{className:"flex justify-end flex-col-reverse sm:flex-row gap-2 mt-5",children:[e.jsx("div",{className:"w-full sm:w-1/12 my-auto text-center",children:e.jsx(i,{href:route("data-ledger.journal",n.id),children:e.jsx(De,{className:"w-full",children:e.jsx("div",{className:"text-center w-full",children:"Batal"})})})}),Y>0&&e.jsx("div",{className:"w-full sm:w-1/12 text-center",children:e.jsx(ke,{className:"w-full",disabled:X,children:e.jsx("div",{className:"text-center w-full",children:"Tambah"})})})]})]})})})]})}Be.layout=n=>e.jsx(we,{header:e.jsx(ge,{children:"Tambah Kas Keluar"}),children:n,user:n.props.auth.user,organization:n.props.organization,title:"Tambah Kas Keluar",backLink:e.jsx(i,{href:route("cashflow.cash-out",n.props.organization.id),children:e.jsx(_e,{})}),breadcrumbs:e.jsx("div",{className:"text-sm breadcrumbs",children:e.jsxs("ul",{children:[e.jsx("li",{className:"font-bold",children:e.jsx(i,{href:route("cashflow",n.props.organization.id),children:"Arus Kas"})}),e.jsx("li",{className:"font-bold",children:e.jsx(i,{href:route("cashflow.cash-out",n.props.organization.id),children:"Kas Keluar"})}),e.jsx("li",{children:"Tambah Kas Keluar"})]})}),role:n.props.role});export{Be as default};
