import{W,r as c,y as G,j as e,Y as J,a as k}from"./app-d483d98c.js";import{H as X}from"./Header-0d522618.js";import{I as o}from"./InputLabel-30f62b92.js";import{T as x}from"./TextInput-5fe4cf75.js";import{P as Z}from"./PrimaryButton-a8005b94.js";import{S as z}from"./SecondaryButton-71a58416.js";import{A as F}from"./AddressSelectInput-a1cbf130.js";import{o as V,u as ee}from"./usePrevious-046b454a.js";import{f as te}from"./index.esm-5ad2d9a7.js";import"./combobox-8ec08d74.js";import"./transition-e9de926c.js";import"./keyboard-18878f20.js";import"./iconBase-d5747956.js";function ae(a,i){let n=a.getDate();return a.setMonth(a.getMonth()+i),a.getDate()!=n&&a.setDate(0),a}function ye({villages:a,villageFilter:i}){var u,g,y,j,v,N;const{data:n,setData:m,post:E,processing:P,errors:s,reset:H}=W({name:"",address:"",expired:"",legality:"",addressDetail:{village:i&&a[0].name,village_id:i&&a[0].id.toString(),district:i&&a[0].district.name,district_id:i&&a[0].district.id.toString(),regency:i&&a[0].district.regency.name,regency_id:i&&a[0].district.regency.id.toString(),province:i&&a[0].district.regency.province.name,province_id:i&&a[0].district.regency.province.id.toString()}}),[O,se]=c.useState(i||""),[t,h]=c.useState(i?a[0]:{}),[l,p]=c.useState(i||""),[Q]=V(l,500),U=ee(O);c.useEffect(()=>{const r=new Date;let d=ae(new Date(r.getFullYear(),r.getMonth(),r.getDate()),1);m("expired",`${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`)},[]),c.useEffect(()=>{U!==void 0&&(Y(),q())},[Q,t]);const Y=()=>{var r,d,f,w,b,S,D,C,_,$,K,M,A,I,L,T;m("addressDetail",{province:t?(f=(d=(r=t==null?void 0:t.district)==null?void 0:r.regency)==null?void 0:d.province)==null?void 0:f.name:"",province_id:t?(D=(S=(b=(w=t==null?void 0:t.district)==null?void 0:w.regency)==null?void 0:b.province)==null?void 0:S.id)==null?void 0:D.toString():"",regency:t?(_=(C=t==null?void 0:t.district)==null?void 0:C.regency)==null?void 0:_.name:"",regency_id:t?(M=(K=($=t==null?void 0:t.district)==null?void 0:$.regency)==null?void 0:K.id)==null?void 0:M.toString():"",district:t?(A=t==null?void 0:t.district)==null?void 0:A.name:"",district_id:t?(L=(I=t==null?void 0:t.district)==null?void 0:I.id)==null?void 0:L.toString():"",village:t?t==null?void 0:t.name:"",village_id:t?(T=t==null?void 0:t.id)==null?void 0:T.toString():""})},q=()=>{G.reload({only:["villages"],data:{village:l},preserveState:!0})},B=r=>{r.preventDefault(),E(route("organization.store"),{onSuccess:()=>H()})},R=()=>{h(""),p("")};return e.jsxs(e.Fragment,{children:[e.jsx(J,{title:"Organization"}),e.jsx("div",{className:"min-h-screen bg-gray-100",children:e.jsxs("div",{className:"max-w-xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-t-lg",children:e.jsx("div",{className:"sm:p-6 px-6 py-6 text-gray-800 text-center",children:e.jsx(X,{children:"Tambah Organisasi"})})}),e.jsx("form",{onSubmit:B,children:e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-b-lg pb-6",children:[e.jsxs("div",{className:"px-6 py-3 text-gray-800",children:[e.jsx(o,{htmlFor:"name",value:"Nama",className:"mx-auto"}),e.jsx(x,{id:"name",type:"text",name:"name",value:n.name,className:`mt-1 w-full ${s&&s.name&&"border-red-500"}`,isFocused:!0,onChange:r=>m("name",r.target.value.toUpperCase()),placeholder:"Nama Organisasi"}),s&&s.name&&e.jsx("div",{className:"-mb-3",children:e.jsx("div",{className:"text-xs text-red-500",children:s.name})})]}),e.jsxs("div",{className:"px-6 py-3 text-gray-800",children:[e.jsx(o,{htmlFor:"address",value:"Alamat",className:"mx-auto"}),e.jsx(x,{id:"address",type:"text",name:"address",value:n.address,className:`mt-1 w-full ${s&&s.address&&"border-red-500"}`,onChange:r=>m("address",r.target.value.toUpperCase()),placeholder:"Alamat Lengkap"}),s&&s.address&&e.jsx("div",{className:"-mb-3",children:e.jsx("div",{className:"text-xs text-red-500",children:s.address})})]}),e.jsxs("div",{className:"px-6 py-3 text-gray-800",children:[e.jsx(o,{htmlFor:"address",value:"Alamat Lengkap",className:"mx-auto"}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:`${t?"w-11/12":"w-full"}`,children:e.jsx(F,{data:a,selected:t,setSelected:h,query:l,setQuery:p,maxHeight:"max-h-40",placeholder:"Cari Desa / Kelurahan"})}),e.jsx("div",{className:`mx-auto my-auto ${t&&"w-1/12"}`,children:t&&e.jsx("button",{className:"p-2",onClick:R,children:e.jsx(te,{})})})]}),t&&e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{children:["Kecamatan: ",(u=t.district)==null?void 0:u.name]}),e.jsxs("div",{children:["Kabupaten/Kota: ",(y=(g=t.district)==null?void 0:g.regency)==null?void 0:y.name]}),e.jsxs("div",{children:["Provinsi: ",(N=(v=(j=t.district)==null?void 0:j.regency)==null?void 0:v.province)==null?void 0:N.name]})]})]}),e.jsxs("div",{className:"px-6 py-3 text-gray-800",children:[e.jsx(o,{htmlFor:"legality",value:"No Legalitas (opsional)",className:"mx-auto"}),e.jsx(x,{id:"legality",type:"text",name:"legality",value:n.legality,className:`mt-1 w-full ${s&&s.legality&&"border-red-500"}`,onChange:r=>m("legality",r.target.value.toUpperCase()),placeholder:"No Legalitas"}),s&&s.legality&&e.jsx("div",{className:"-mb-3",children:e.jsx("div",{className:"text-xs text-red-500",children:s.legality})})]}),e.jsxs("div",{className:"px-6 py-3 text-gray-800 text-center md:flex sm:rouded-b-lg",children:[e.jsx("div",{className:"mt-1 text-center md:mt-0 md:w-1/4 md:flex-1 md:mx-10 hidden md:block",children:e.jsx(k,{href:"/organizations",children:e.jsx(z,{className:"w-full md:min-w-max",children:e.jsx("div",{className:"w-full text-center",children:"Kembali"})})})}),e.jsx("div",{className:"md:w-1/4 md:flex-1 md:mx-10",children:e.jsx(Z,{className:"w-full md:min-w-max",disabled:P,children:e.jsx("div",{className:"w-full text-center",children:"Tambah"})})}),e.jsx("div",{className:"mt-1 text-center md:hidden",children:e.jsx(k,{href:"/organizations",children:e.jsx(z,{className:"w-full md:min-w-max",children:e.jsx("div",{className:"w-full text-center",children:"Kembali"})})})})]})]})})]})})]})}export{ye as default};
