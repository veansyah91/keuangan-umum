import{m as Z,r,S as j,j as a,L as aa,$ as i}from"./app-e83142f3.js";import{A as ea}from"./AuthenticatedLayout-9fce3876.js";import{H as sa}from"./Header-62783548.js";import{k as ta,Q as c}from"./react-toastify.esm-24c54db9.js";/* empty css                      */import{I as g,a as v,b as na,c as la}from"./index.esm-b77cfcfa.js";import{A as oa}from"./AddButtonMobile-5b41a6d8.js";import{M as E}from"./Modal-8147e6bd.js";import{S as P}from"./SecondaryButton-a19a00db.js";import{P as B}from"./PrimaryButton-8f455cec.js";import{C as ia}from"./ContainerDesktop-c52dc2d4.js";import{T as ra,a as ca,P as da,C as ha}from"./ContentDesktop-2968678f.js";import{C as ua}from"./ContentMobile-61b7ae96.js";import ma from"./SavingBalanceMobile-021f32f5.js";import xa from"./SavingBalanceDesktop-eab78027.js";import{I as _}from"./InputLabel-8c78f10a.js";import{T as pa}from"./TextInput-b1394ab8.js";import{C as fa}from"./ClientSelectInput-5b99565d.js";import{D as ja}from"./DangerButton-fdcb9341.js";import{C as ga}from"./ContactSelectInput-f39786c9.js";import{a as va,u as Na}from"./index.module-b9fb6ad6.js";import"./ApplicationLogo-b4a187c6.js";import"./iconBase-c9c81c8c.js";import"./transition-155365a3.js";import"./dayjs.min-55994c47.js";import"./portal-16ac43ea.js";import"./close-provider-3bd0d8d7.js";import"./formatNumber-b542c689.js";import"./combobox-f36570d5.js";function ya({organization:t,role:x,members:s,querySearch:O,newRef:S,contacts:M,categories:F}){const{data:d,setData:h,post:A,patch:K,errors:n,processing:w,reset:_a,delete:R}=Z({id:null,no_ref:S||"",contact_id:null,saving_category_id:null}),[z,N]=r.useState({id:null,name:"",phone:""}),[H,y]=r.useState({id:null,name:""}),[L,p]=r.useState(!1),[U,u]=r.useState(!1),[$,f]=r.useState(!1),[b,C]=r.useState({title:"Tambah Data Simpanan",submit:"Tambah"}),[o,D]=r.useState(O||""),[Q]=va(o,500),V=Na(o);r.useEffect(()=>{V!==void 0&&q()},[Q]);const q=()=>{j.reload({only:["members"],data:{search:o},preserveState:!0})},G=()=>{h({id:null,no_ref:S||"",contact_id:null,saving_category_id:null}),N({id:null,name:"",phone:""}),y({id:null,name:""})},J=e=>{e&&(N({id:e==null?void 0:e.id,name:e==null?void 0:e.name,phone:e==null?void 0:e.phone}),h("contact_id",e==null?void 0:e.id))},W=e=>{e&&(h("saving_category_id",e==null?void 0:e.id),y({id:e==null?void 0:e.id,name:e==null?void 0:e.name}))},T=()=>{u(!0),f(!1),G(),C({title:"Tambah Data Simpanan",submit:"Tambah"})},I=e=>{p(!0),h({id:e.id,no_ref:e.no_ref,contact_id:e.contact_id,saving_category_id:e.saving_category_id})},k=e=>{C({title:"Ubah Kategori",submit:"Ubah"}),u(!0),h({id:e.id,no_ref:e.no_ref,contact_id:e.contact_id,saving_category_id:e.saving_category_id}),N({id:e.contact.id,name:e.contact.name,phone:e.contact.phone}),y({id:e.saving_category.id,name:e.saving_category.name}),f(!0)},X=e=>{e.preventDefault(),R(route("cashflow.saving.balance.delete",{organization:t.id,balance:d.id}),{onSuccess:({props:l})=>{const{flash:m}=l;c.success(m.success,{position:c.POSITION.TOP_CENTER}),j.replace(window.location.pathname),p(!1)}})},Y=e=>{e.preventDefault(),$?K(route("cashflow.saving.balance.update",{organization:t.id,balance:d.id}),{onSuccess:({props:l})=>{const{flash:m}=l;c.success(m.success,{position:c.POSITION.TOP_CENTER}),j.get(window.location.pathname),u(!1),f(!1)}}):A(route("cashflow.saving.balance.store",{organization:t}),{onSuccess:({props:l})=>{const{flash:m}=l;c.success(m.success,{position:c.POSITION.TOP_CENTER}),j.get(window.location.pathname),u(!1),f(!1)},onError:l=>{c.error(l.error,{position:c.POSITION.TOP_CENTER})}})};return a.jsxs(a.Fragment,{children:[a.jsx(aa,{title:"Data Simpanan"}),a.jsx(ta,{}),x!=="viewer"&&a.jsx(oa,{label:"Tambah",handleShowInputModal:T}),a.jsx(ra,{zIndex:"z-50",search:o,setSearch:e=>D(e.target.value),pageBefore:s.links[0].url?a.jsx(i,{href:route("cashflow.saving.balance",{organization:t.id,page:s.current_page-1,search:o}),preserveState:!0,only:["members"],children:a.jsx(g,{})}):a.jsx("div",{className:"text-gray-300",children:a.jsx(g,{})}),pageAfter:s.links[s.links.length-1].url?a.jsx(i,{href:route("cashflow.saving.balance",{organization:t.id,page:s.current_page+1,search:o}),only:["members"],preserveState:!0,children:a.jsx(v,{})}):a.jsx("div",{className:"text-gray-300",children:a.jsx(v,{})}),page:a.jsxs(a.Fragment,{children:[s.current_page,"/",s.last_page]}),data:s}),a.jsx(ua,{children:s.data.map(e=>a.jsx(ma,{member:e,handleDelete:()=>I(e),handleEdit:()=>k(e),role:x},e.id))}),a.jsxs(ia,{children:[a.jsxs(ca,{children:[a.jsx("div",{className:"my-auto w-7/12",children:x!=="viewer"&&a.jsx("div",{className:"space-x-2",children:a.jsx(B,{className:"py-3",onClick:T,children:"Tambah Data"})})}),a.jsxs("div",{className:"w-3/12 border flex rounded-lg",children:[a.jsx("label",{htmlFor:"search-input",className:"my-auto ml-2",children:a.jsx(na,{})}),a.jsx("input",{id:"search-input",name:"search-input",type:"search",placeholder:"Cari Data Tabungan",className:"w-full border-none focus:outline-none focus:ring-0",value:o||"",onChange:e=>D(e.target.value)})]}),a.jsx("div",{className:"italic text-xs my-auto w-1/12 text-center",children:a.jsx(da,{data:s})}),a.jsxs("div",{className:"my-auto flex space-x-2 w-1/12",children:[a.jsx("div",{className:"my-auto",children:s.links[0].url?a.jsx(i,{href:route("cashflow.saving.balance",{organization:t.id,page:s.current_page-1,search:o}),preserveState:!0,only:["members"],children:a.jsx(g,{})}):a.jsx("div",{className:"text-gray-300",children:a.jsx(g,{})})}),a.jsxs("div",{className:"my-auto",children:[s.current_page,"/",s.last_page]}),a.jsx("div",{className:"my-auto",children:s.links[s.links.length-1].url?a.jsx(i,{href:route("cashflow.saving.balance",{organization:t.id,page:s.current_page+1,search:o}),only:["members"],preserveState:!0,children:a.jsx(v,{})}):a.jsx("div",{className:"text-gray-300",children:a.jsx(v,{})})})]})]}),a.jsx("div",{className:"sm:flex hidden gap-5",children:a.jsx("div",{className:"w-full",children:a.jsx(ha,{children:a.jsxs("table",{className:"table table-pin-rows table-pin-cols text-base",children:[a.jsx("thead",{className:"text-base text-gray-900",children:a.jsxs("tr",{className:"",children:[a.jsx("th",{className:"bg-gray-200",children:"No. Ref"}),a.jsx("th",{className:"bg-gray-200",children:"Nama Kontak"}),a.jsx("th",{className:"bg-gray-200",children:"Kategori Simpanan"}),a.jsx("th",{className:"bg-gray-200 text-end",children:"Saldo"}),a.jsx("th",{className:"bg-gray-200"})]})}),a.jsx("tbody",{children:s.data.map((e,l)=>a.jsx(xa,{member:e,className:`${l%2==0&&"bg-gray-100"}`,handleDelete:()=>I(e),handleEdit:()=>k(e),role:x},l))})]})})})})]}),a.jsx(E,{show:U,onClose:()=>u(!1),children:a.jsxs("form",{onSubmit:Y,className:"p-6",children:[a.jsx("h2",{className:"text-lg font-medium text-gray-900 border-b-2 py-1",children:b.title}),a.jsxs("div",{className:"mt-5 space-y-5",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-1",children:[a.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:a.jsx(_,{htmlFor:"no_ref",value:"No. Ref",className:"mx-auto my-auto"})}),a.jsxs("div",{className:"sm:w-2/3 w-full",children:[a.jsx(pa,{id:"no_ref",type:"text",name:"no_ref",value:d.no_ref,className:`mt-1 w-full ${n&&n.no_ref&&"border-red-500"}`,isFocused:!0,onChange:e=>h("no_ref",e.target.value.toUpperCase()),placeholder:"No. Ref"}),n&&n.no_ref&&a.jsx("div",{className:"-mb-3",children:a.jsx("div",{className:"text-xs text-red-500",children:n.no_ref})})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-1",children:[a.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:a.jsx(_,{htmlFor:"contact_id",value:"Kontak",className:"mx-auto my-auto"})}),a.jsxs("div",{className:"sm:w-2/3 w-full",children:[a.jsx(ga,{resources:M,selected:z,setSelected:e=>J(e),maxHeight:"max-h-40",placeholder:"Cari Kontak",isError:!!n.contact_id,id:"contact",notFound:a.jsxs("span",{children:["Tidak Ada Data. ",a.jsx(i,{className:"font-bold text-blue-600",href:route("data-master.contact.create",{organization:t.id}),children:"Buat Baru ?"})]})}),n&&n.contact_id&&a.jsx("div",{className:"-mb-3",children:a.jsx("div",{className:"text-xs text-red-500",children:n.contact_id})})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-1",children:[a.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:a.jsx(_,{htmlFor:"category",value:"Kategori Tabungan",className:"mx-auto my-auto"})}),a.jsxs("div",{className:"sm:w-2/3 w-full",children:[a.jsx(fa,{resources:F,selected:H,setSelected:e=>W(e),maxHeight:"max-h-40",placeholder:"Cari Kategori",isError:!!n.saving_category_id,notFound:a.jsxs("span",{children:["Tidak Ada Data. ",a.jsx(i,{className:"font-bold text-blue-600",href:route("data-ledger.account",{organization:t.id}),children:"Buat Baru ?"})]})}),n&&n.category&&a.jsx("div",{className:"-mb-3",children:a.jsx("div",{className:"text-xs text-red-500",children:n.category})})]})]}),a.jsxs("div",{className:"mt-6 flex justify-end",children:[a.jsx(P,{onClick:e=>u(!1),children:"Batal"}),a.jsx(B,{className:"ms-3",disabled:w,children:b.submit})]})]})]})}),a.jsx(E,{show:L,onClose:()=>p(!1),children:a.jsxs("form",{onSubmit:X,className:"p-6",id:"delete-confirmation",name:"delete-confirmation",children:[a.jsx("h2",{className:"text-lg font-medium text-gray-900 text-center",children:a.jsxs("div",{children:["Hapus Data Simpanan ",d==null?void 0:d.no_ref,"?"]})}),a.jsxs("div",{className:"mt-6 flex justify-end",children:[a.jsx(P,{onClick:()=>p(!1),children:"Batal"}),a.jsx(ja,{className:"ms-3",disabled:w,children:"Hapus"})]})]})})]})}ya.layout=t=>a.jsx(ea,{header:a.jsx(sa,{children:"Data Simpanan"}),children:t,user:t.props.auth.user,organization:t.props.organization,title:"Data Simpanan",backLink:a.jsx(i,{href:route("cashflow.saving",t.props.organization.id),children:a.jsx(la,{})}),breadcrumbs:a.jsx("div",{className:"text-sm breadcrumbs",children:a.jsxs("ul",{children:[a.jsx("li",{className:"font-bold",children:a.jsx(i,{href:route("cashflow",t.props.organization.id),children:"Arus Kas"})}),a.jsx("li",{className:"font-bold",children:a.jsx(i,{href:route("cashflow.saving",t.props.organization.id),children:"Simpanan"})}),a.jsx("li",{children:"Data Simpanan"})]})}),role:t.props.role});export{ya as default};
