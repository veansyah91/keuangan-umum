import{r as c,W as ue,y as xe,j as e,Y as pe,a as N}from"./app-d483d98c.js";import{D as he,A as je}from"./AuthenticatedLayout-a772dc4c.js";import{H as fe}from"./Header-0d522618.js";import{k as v,r as ve,n as Ne,c as we}from"./index.esm-5ad2d9a7.js";import{S as ge}from"./SecondaryButton-71a58416.js";import{P as be}from"./PrimaryButton-a8005b94.js";import{F as ye}from"./FormInput-852fcf10.js";import{k as _e,Q as P}from"./react-toastify.esm-3f550885.js";import{I as d}from"./InputLabel-30f62b92.js";import{T as S}from"./TextInput-5fe4cf75.js";import{o as Se,u as De}from"./usePrevious-046b454a.js";import{N as Ce}from"./react-number-format.es-def885d2.js";import{C as p}from"./ClientSelectInput-8c342ce7.js";import{C as Ae}from"./ContactSelectInput-ff6441bc.js";import{f as Ke}from"./formatNumber-b542c689.js";import{d as I}from"./dayjs.min-1195a0c5.js";import{A as D}from"./disclosure-ff5cafb1.js";import{q as ke}from"./transition-e9de926c.js";import"./ApplicationLogo-0888e530.js";import"./iconBase-d5747956.js";/* empty css                      */import"./combobox-8ec08d74.js";import"./keyboard-18878f20.js";function Ee({cashOut:t,organization:C,newRef:Pe,date:Ie,accounts:F,cashAccounts:T,projects:w,programs:g,departments:b,contacts:B}){const[i,y]=c.useState(t.selectedAccount),[R,U]=c.useState({id:t.contact.id,name:t.contact.name,phone:t.contact.phone});c.useState("");const[u,H]=c.useState(t.cashAccount),[Fe,V]=c.useState(""),[_,A]=c.useState(["",""]),[h,K]=c.useState({id:t.journal.project_id,name:t.journal.project_id?t.journal.project.name:"",code:t.journal.project_id?t.journal.project.codes:""}),[$,Te]=c.useState(""),[j,k]=c.useState({id:t.journal.program_id,name:t.journal.program_id?t.journal.program.name:"",code:t.journal.program_id?t.journal.program.codes:""}),[z,Be]=c.useState(""),[f,E]=c.useState({id:t.journal.department_id,name:t.journal.department_id?t.journal.department.name:"",code:t.journal.department_id?t.journal.department.codes:""}),[L,Re]=c.useState(""),[x,Y]=c.useState({startDate:t.date,endDate:t.date}),[M,q]=c.useState(0),{data:n,setData:r,patch:Q,reset:Ue,errors:m,setError:He,processing:W}=ue({date:t.date,contact_id:t.contact_id,no_ref:t.no_ref,description:t.description,program_id:t.journal.program_id,project_id:t.journal.project_id,department_id:t.journal.department_id,is_approved:t.journal.is_approved,cash_account_id:t.cashAccount.id,accounts:t.accounts}),[G]=Se(x,500),J=De(x);c.useEffect(()=>{if(J!==void 0){let s=I(x.startDate),a=`${s.month()+1}-${s.year()}`,l=I(t.date),o=`${l.month()+1}-${l.year()}`;a!==o?Z():r("no_ref",t.no_ref)}},[G]),c.useEffect(()=>{let s=n.accounts.reduce((a,l)=>a+l.value,0);q(s)},[n]);const X=s=>{s.preventDefault(),Q(route("cashflow.cash-out.update",{organization:C.id,cashOut:t.id}),{onSuccess:a=>{P.success("Kas Keluar Berhasil Diubah",{position:P.POSITION.TOP_CENTER})},onError:a=>{V(a.cash_account_id)}})},Z=()=>{xe.reload({only:["newRef"],data:{date:x.startDate},onSuccess:s=>{r("no_ref",s.props.newRef)}})},O=s=>{U({id:s.id,name:s.name,phone:s.phone});let a=n;a={...a,contact_id:s.id,description:`Kas Keluar dari ${s.name.toUpperCase()}`},r(a)},ee=s=>{H({id:s.id,name:s.name,code:s.code,is_cash:!0}),r("cash_account_id",s.id)},se=(s,a)=>{const l=[...i],o=[...n.accounts];l[a]=s,o[a]={...o[a],id:s.id,name:s.name,code:s.code,is_cash:s.is_cash},y(l),r("accounts",o)},te=(s,a)=>{const{value:l}=s,o=[...n.accounts];o[a]={...o[a],value:parseInt(l)},r("accounts",o)},ae=s=>{Y(s),r("date",s.startDate)},le=()=>{const s=[...n.accounts,{id:null,name:"",code:"",value:0,is_cash:!1}];r("accounts",s);const a=[...i,{id:null,name:"",code:"",is_cash:!1}];y(a);let l=[..._];l=[...l,""],A(l)},re=s=>{const a=[...n.accounts];a.splice(s,1),r("accounts",a);const l=[...i];l.splice(s,1),y(l);let o=[..._];o.splice(s,1),A(o)},oe=s=>{k(s),r("program_id",s.id)},ce=()=>{k({id:null,name:"",code:""}),r("program_id",null)},ne=s=>{K(s),r("project_id",s.id)},de=()=>{K({id:null,name:"",code:""}),r("project_id",null)},ie=s=>{E(s),r("department_id",s.id)},me=()=>{E({id:null,name:"",code:""}),r("department_id",null)};return e.jsxs(e.Fragment,{children:[e.jsx(pe,{title:"Ubah Kas Keluar"}),e.jsx(_e,{}),e.jsx(ye,{onSubmit:X,children:e.jsx("div",{className:"w-full sm:mt-2 sm:py-5",children:e.jsxs("div",{className:"sm:mx-auto px-3 sm:px-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Nama Kontak",htmlFor:"contact"})}),e.jsx("div",{children:e.jsx(Ae,{resources:B,selected:R,setSelected:s=>O(s),maxHeight:"max-h-40",placeholder:"Cari Kontak",isError:!!m.contact_id,id:"contact"})})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Ke Akun Kas",htmlFor:"cash_account"})}),e.jsxs("div",{children:[e.jsx(p,{resources:T,selected:u,setSelected:s=>ee(s),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!m.cash_account_id,id:"cash_account"}),(u==null?void 0:u.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",u.code]})]})]}),e.jsx("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 mt-7",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Tanggal"})}),e.jsx("div",{children:e.jsx(he,{value:x,onChange:ae,inputClassName:(m==null?void 0:m.date)&&"border-red-500 rounded-lg",useRange:!1,asSingle:!0,placeholder:"Tanggal",id:"date",displayFormat:"MMMM DD, YYYY"})})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"No. Ref",htmlFor:"no_ref"})}),e.jsx("div",{children:e.jsx(S,{id:"no_ref",className:`w-full ${m.no_ref&&"border-red-500"}`,value:n.no_ref,onChange:s=>r("no_ref",s.target.value)})})]}),e.jsxs("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Deskripsi",htmlFor:"description"})}),e.jsx("div",{children:e.jsx(S,{id:"description",className:"w-full",value:n.description,onChange:s=>r("description",s.target.value)})})]})]}),(w.length>0||g.length>0||b.length>0)&&e.jsx("div",{className:"mt-3",children:e.jsx(D,{children:({open:s})=>e.jsxs(e.Fragment,{children:[e.jsx(ke,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsx(D.Panel,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:[g.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Program Kegiatan",htmlFor:"program"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(p,{resources:g,selected:j,setSelected:a=>oe(a),maxHeight:"max-h-40",placeholder:"Cari Program Kegiatan",isError:!!z,id:"program"}),j.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",j.code]})]}),j.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:ce,children:e.jsx(v,{})})})]})]}),w.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Proyek",htmlFor:"project"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(p,{resources:w,selected:h,setSelected:a=>ne(a),maxHeight:"max-h-40",placeholder:"Cari Proyek",isError:!!$,id:"project"}),h.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",h.code]})]}),h.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:de,children:e.jsx(v,{})})})]})]}),b.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Departemen",htmlFor:"department"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(p,{resources:b,selected:f,setSelected:a=>ie(a),maxHeight:"max-h-40",placeholder:"Cari Departemen",isError:!!L,id:"department"}),f.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",f.code]})]}),f.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:me,children:e.jsx(v,{})})})]})]})]})})}),e.jsx(D.Button,{className:"flex w-full justify-between rounded-lg bg-slate-100 px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-slate-500/75",children:e.jsxs("div",{className:"flex justify-center w-full gap-3",children:[e.jsxs("span",{children:["Tampilkan Lebih ",s?"Sedikit":"Banyak"]}),e.jsx(ve,{className:`${s?"":"rotate-180 transform"} h-5 w-5 text-slate-500`})]})})]})})}),e.jsx("div",{className:"mt-5",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"md:flex font-bold gap-3 border-b py-3 hidden",children:[e.jsx("div",{className:"w-5/12",children:"AKUN"}),e.jsx("div",{className:"w-3/12 text-end"}),e.jsx("div",{className:"w-3/12 text-end",children:"NILAI"}),e.jsx("div",{className:"w-1/12 text-center",children:"#"})]}),n.accounts.map((s,a)=>{var l;return e.jsxs("div",{className:"md:flex gap-3 py-3 mt-2 space-y-2 border md:border-none rounded-lg border-slate-900 px-3",children:[e.jsxs("div",{className:"md:hidden text-slate-800",children:["Baris : ",a+1]}),e.jsxs("div",{className:"md:w-5/12 w-full relative",children:[e.jsx(p,{resources:F,selected:i[a],setSelected:o=>se(o,a),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!_[a]}),((l=i[a])==null?void 0:l.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",i[a].code]})]}),e.jsx("div",{className:"md:w-3/12 w-full text-end my-auto"}),e.jsx("div",{className:"md:w-3/12 w-full text-end my-auto",children:e.jsx(Ce,{value:s.value,customInput:S,onValueChange:o=>te(o,a),thousandSeparator:!0,className:"text-end w-full",prefix:"IDR "})}),e.jsx("div",{className:"md:w-1/12 w-full text-center my-auto",children:e.jsx("button",{type:"button",className:"md:text-red-500 text-white bg-red-500 md:bg-white text-xl hover:bg-slate-200 rounded-full p-2 w-full",onClick:()=>re(a),children:e.jsx("div",{className:"text-center",children:e.jsx(v,{className:"text-center w-full"})})})})]},a)}),e.jsx("div",{className:"py-3 mt-4",children:e.jsxs("button",{className:"w-full border bg-slate-100 hover:bg-slate-200 text-slate-500 py-3 flex justify-center gap-2",type:"button",onClick:le,children:[e.jsx("div",{className:"my-auto",children:e.jsx(Ne,{})}),e.jsx("div",{children:"Ubah Baris Baru"})]})})]})}),e.jsxs("div",{className:"md:flex font-bold gap-3",children:[e.jsx("div",{className:"w-5/12"}),e.jsxs("div",{className:"md:w-7/12 flex border-t py-3 gap-12 px-3",children:[e.jsx("div",{className:"w-1/2",children:"TOTAL "}),e.jsxs("div",{className:"w-1/2 text-end",children:["IDR ",Ke(M)]})]})]}),e.jsxs("div",{className:"md:flex font-bold gap-3",children:[e.jsx("div",{className:"w-5/12"}),e.jsx("div",{className:"md:w-7/12 flex border-t py-3 gap-2 px-3",children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer gap-2",htmlFor:"checkbox",children:[e.jsx("input",{type:"checkbox",className:"checkbox",id:"checkbox",value:!n.is_approved,onChange:()=>r("is_approved",!n.is_approved),checked:!n.is_approved}),e.jsx("span",{className:"label-text",children:"Simpan Ke Dalam Draft"})]})})})]}),e.jsxs("div",{className:"flex justify-end flex-col-reverse sm:flex-row gap-2 mt-5",children:[e.jsx("div",{className:"w-full sm:w-1/12 my-auto text-center",children:e.jsx(N,{href:route("cashflow.cash-out",C.id),children:e.jsx(ge,{className:"w-full",children:e.jsx("div",{className:"text-center w-full",children:"Batal"})})})}),e.jsx("div",{className:"w-full sm:w-1/12 text-center",children:e.jsx(be,{className:"w-full",disabled:W,children:e.jsx("div",{className:"text-center w-full",children:"Ubah"})})})]})]})})})]})}Ee.layout=t=>e.jsx(je,{header:e.jsx(fe,{children:"Ubah Kas Keluar"}),children:t,user:t.props.auth.user,organization:t.props.organization,title:"Ubah Kas Keluar",backLink:e.jsx(N,{href:route("cashflow.cash-out",t.props.organization.id),children:e.jsx(we,{})}),breadcrumbs:e.jsx("div",{className:"text-sm breadcrumbs",children:e.jsxs("ul",{children:[e.jsx("li",{className:"font-bold",children:e.jsx(N,{href:route("cashflow",t.props.organization.id),children:"Arus Kas"})}),e.jsx("li",{className:"font-bold",children:e.jsx(N,{href:route("cashflow.cash-out",t.props.organization.id),children:"Kas Keluar"})}),e.jsx("li",{children:"Ubah Kas Keluar"})]})}),role:t.props.role});export{Ee as default};
