import{m as Z,r as c,S as j,j as a,L as aa,$ as i}from"./app-c3de5fa6.js";import{A as ea}from"./AuthenticatedLayout-2f82e08a.js";import{H as sa}from"./Header-ee160182.js";import{k as ta,Q as o}from"./react-toastify.esm-94b2ee7c.js";/* empty css                      */import{I as g,a as v,b as na,c as la}from"./index.esm-234976fb.js";import{A as oa}from"./AddButtonMobile-0d121cb0.js";import{M as E}from"./Modal-5f8d8618.js";import{S as P}from"./SecondaryButton-fcf7be1a.js";import{P as O}from"./PrimaryButton-02cc0a94.js";import{C as ra}from"./ContainerDesktop-744bb52e.js";import{T as ia,a as ca,P as da,C as ha}from"./ContentDesktop-8217dec4.js";import{C as ua}from"./ContentMobile-168e507c.js";import ma from"./SavingBalanceMobile-1e289368.js";import xa from"./SavingBalanceDesktop-be296a68.js";import{I as _}from"./InputLabel-60badb3d.js";import{T as pa}from"./TextInput-ebb8b1c3.js";import{C as fa}from"./ClientSelectInput-8df18255.js";import{D as ja}from"./DangerButton-9faf9837.js";import{C as ga}from"./ContactSelectInput-09c5f4dd.js";import{a as va,u as Na}from"./index.module-1bc829eb.js";import"./ApplicationLogo-33e039c9.js";import"./iconBase-23c1fa9a.js";import"./transition-294d1a88.js";import"./dayjs.min-c211a108.js";import"./portal-97852d2d.js";import"./close-provider-c2a46ce3.js";import"./formatNumber-b542c689.js";import"./index.esm-4c092f94.js";import"./combobox-41255761.js";function ya({organization:t,role:x,members:s,querySearch:B,newRef:S,contacts:M,categories:F}){const{data:d,setData:h,post:A,patch:R,errors:n,processing:w,reset:_a,delete:K}=Z({id:null,no_ref:S||"",contact_id:null,saving_category_id:null}),[z,N]=c.useState({id:null,name:"",phone:""}),[H,y]=c.useState({id:null,name:""}),[L,p]=c.useState(!1),[U,u]=c.useState(!1),[$,f]=c.useState(!1),[b,C]=c.useState({title:"Tambah Data Simpanan",submit:"Tambah"}),[r,T]=c.useState(B||""),[Q]=va(r,500),V=Na(r);c.useEffect(()=>{V!==void 0&&q()},[Q]);const q=()=>{j.reload({only:["members"],data:{search:r},preserveState:!0})},G=()=>{h({id:null,no_ref:S||"",contact_id:null,saving_category_id:null}),N({id:null,name:"",phone:""}),y({id:null,name:""})},J=e=>{e&&(N({id:e==null?void 0:e.id,name:e==null?void 0:e.name,phone:e==null?void 0:e.phone}),h("contact_id",e==null?void 0:e.id))},W=e=>{e&&(h("saving_category_id",e==null?void 0:e.id),y({id:e==null?void 0:e.id,name:e==null?void 0:e.name}))},D=()=>{u(!0),f(!1),G(),C({title:"Tambah Data Simpanan",submit:"Tambah"})},I=e=>{p(!0),h({id:e.id,no_ref:e.no_ref,contact_id:e.contact_id,saving_category_id:e.saving_category_id})},k=e=>{C({title:"Ubah Kategori",submit:"Ubah"}),u(!0),h({id:e.id,no_ref:e.no_ref,contact_id:e.contact_id,saving_category_id:e.saving_category_id}),N({id:e.contact.id,name:e.contact.name,phone:e.contact.phone}),y({id:e.saving_category.id,name:e.saving_category.name}),f(!0)},X=e=>{e.preventDefault(),K(route("cashflow.saving.balance.delete",{organization:t.id,balance:d.id}),{onSuccess:({props:l})=>{const{flash:m}=l;o.success(m.success,{position:o.POSITION.TOP_CENTER}),j.replace(window.location.pathname),p(!1)},onError:l=>{o.error(l.error,{position:o.POSITION.TOP_CENTER})}})},Y=e=>{e.preventDefault(),$?R(route("cashflow.saving.balance.update",{organization:t.id,balance:d.id}),{onSuccess:({props:l})=>{const{flash:m}=l;o.success(m.success,{position:o.POSITION.TOP_CENTER}),j.get(window.location.pathname),u(!1),f(!1)}}):A(route("cashflow.saving.balance.store",{organization:t}),{onSuccess:({props:l})=>{const{flash:m}=l;o.success(m.success,{position:o.POSITION.TOP_CENTER}),j.get(window.location.pathname),u(!1),f(!1)},onError:l=>{o.error(l.error,{position:o.POSITION.TOP_CENTER})}})};return a.jsxs(a.Fragment,{children:[a.jsx(aa,{title:"Data Simpanan"}),a.jsx(ta,{}),x!=="viewer"&&a.jsx(oa,{label:"Tambah",handleShowInputModal:D}),a.jsx(ia,{zIndex:"z-50",search:r,setSearch:e=>T(e.target.value),pageBefore:s.links[0].url?a.jsx(i,{href:route("cashflow.saving.balance",{organization:t.id,page:s.current_page-1,search:r}),preserveState:!0,only:["members"],children:a.jsx(g,{})}):a.jsx("div",{className:"text-gray-300",children:a.jsx(g,{})}),pageAfter:s.links[s.links.length-1].url?a.jsx(i,{href:route("cashflow.saving.balance",{organization:t.id,page:s.current_page+1,search:r}),only:["members"],preserveState:!0,children:a.jsx(v,{})}):a.jsx("div",{className:"text-gray-300",children:a.jsx(v,{})}),page:a.jsxs(a.Fragment,{children:[s.current_page,"/",s.last_page]}),data:s}),a.jsx(ua,{children:s.data.map(e=>a.jsx(ma,{member:e,handleDelete:()=>I(e),handleEdit:()=>k(e),role:x},e.id))}),a.jsxs(ra,{children:[a.jsxs(ca,{children:[a.jsx("div",{className:"my-auto w-7/12",children:x!=="viewer"&&a.jsx("div",{className:"space-x-2",children:a.jsx(O,{className:"py-3",onClick:D,children:"Tambah Data"})})}),a.jsxs("div",{className:"w-3/12 border flex rounded-lg",children:[a.jsx("label",{htmlFor:"search-input",className:"my-auto ml-2",children:a.jsx(na,{})}),a.jsx("input",{id:"search-input",name:"search-input",type:"search",placeholder:"Cari Data Tabungan",className:"w-full border-none focus:outline-none focus:ring-0",value:r||"",onChange:e=>T(e.target.value)})]}),a.jsx("div",{className:"italic text-xs my-auto w-1/12 text-center",children:a.jsx(da,{data:s})}),a.jsxs("div",{className:"my-auto flex space-x-2 w-1/12",children:[a.jsx("div",{className:"my-auto",children:s.links[0].url?a.jsx(i,{href:route("cashflow.saving.balance",{organization:t.id,page:s.current_page-1,search:r}),preserveState:!0,only:["members"],children:a.jsx(g,{})}):a.jsx("div",{className:"text-gray-300",children:a.jsx(g,{})})}),a.jsxs("div",{className:"my-auto",children:[s.current_page,"/",s.last_page]}),a.jsx("div",{className:"my-auto",children:s.links[s.links.length-1].url?a.jsx(i,{href:route("cashflow.saving.balance",{organization:t.id,page:s.current_page+1,search:r}),only:["members"],preserveState:!0,children:a.jsx(v,{})}):a.jsx("div",{className:"text-gray-300",children:a.jsx(v,{})})})]})]}),a.jsx("div",{className:"sm:flex hidden gap-5",children:a.jsx("div",{className:"w-full",children:a.jsx(ha,{children:a.jsxs("table",{className:"table table-pin-rows table-pin-cols text-base",children:[a.jsx("thead",{className:"text-base text-gray-900",children:a.jsxs("tr",{className:"",children:[a.jsx("th",{className:"bg-gray-200",children:"No. Ref"}),a.jsx("th",{className:"bg-gray-200",children:"Nama Kontak"}),a.jsx("th",{className:"bg-gray-200",children:"Kategori Simpanan"}),a.jsx("th",{className:"bg-gray-200 text-end",children:"Saldo"}),a.jsx("th",{className:"bg-gray-200"})]})}),a.jsx("tbody",{children:s.data.map((e,l)=>a.jsx(xa,{member:e,className:`${l%2==0&&"bg-gray-100"}`,handleDelete:()=>I(e),handleEdit:()=>k(e),role:x},l))})]})})})})]}),a.jsx(E,{show:U,onClose:()=>u(!1),children:a.jsxs("form",{onSubmit:Y,className:"p-6",children:[a.jsx("h2",{className:"text-lg font-medium text-gray-900 border-b-2 py-1",children:b.title}),a.jsxs("div",{className:"mt-5 space-y-5",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-1",children:[a.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:a.jsx(_,{htmlFor:"no_ref",value:"No. Ref",className:"mx-auto my-auto"})}),a.jsxs("div",{className:"sm:w-2/3 w-full",children:[a.jsx(pa,{id:"no_ref",type:"text",name:"no_ref",value:d.no_ref,className:`mt-1 w-full ${n&&n.no_ref&&"border-red-500"}`,isFocused:!0,onChange:e=>h("no_ref",e.target.value.toUpperCase()),placeholder:"No. Ref"}),n&&n.no_ref&&a.jsx("div",{className:"-mb-3",children:a.jsx("div",{className:"text-xs text-red-500",children:n.no_ref})})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-1",children:[a.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:a.jsx(_,{htmlFor:"contact_id",value:"Kontak",className:"mx-auto my-auto"})}),a.jsxs("div",{className:"sm:w-2/3 w-full",children:[a.jsx(ga,{resources:M,selected:z,setSelected:e=>J(e),maxHeight:"max-h-40",placeholder:"Cari Kontak",isError:!!n.contact_id,id:"contact",notFound:a.jsxs("span",{children:["Tidak Ada Data. ",a.jsx(i,{className:"font-bold text-blue-600",href:route("data-master.contact.create",{organization:t.id}),children:"Buat Baru ?"})]})}),n&&n.contact_id&&a.jsx("div",{className:"-mb-3",children:a.jsx("div",{className:"text-xs text-red-500",children:n.contact_id})})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-1",children:[a.jsx("div",{className:"w-full sm:w-1/3 my-auto",children:a.jsx(_,{htmlFor:"category",value:"Kategori Tabungan",className:"mx-auto my-auto"})}),a.jsxs("div",{className:"sm:w-2/3 w-full",children:[a.jsx(fa,{resources:F,selected:H,setSelected:e=>W(e),maxHeight:"max-h-40",placeholder:"Cari Kategori",isError:!!n.saving_category_id,notFound:a.jsxs("span",{children:["Tidak Ada Data. ",a.jsx(i,{className:"font-bold text-blue-600",href:route("data-ledger.account",{organization:t.id}),children:"Buat Baru ?"})]})}),n&&n.category&&a.jsx("div",{className:"-mb-3",children:a.jsx("div",{className:"text-xs text-red-500",children:n.category})})]})]}),a.jsxs("div",{className:"mt-6 flex justify-end",children:[a.jsx(P,{onClick:e=>u(!1),children:"Batal"}),a.jsx(O,{className:"ms-3",disabled:w,children:b.submit})]})]})]})}),a.jsx(E,{show:L,onClose:()=>p(!1),children:a.jsxs("form",{onSubmit:X,className:"p-6",id:"delete-confirmation",name:"delete-confirmation",children:[a.jsx("h2",{className:"text-lg font-medium text-gray-900 text-center",children:a.jsxs("div",{children:["Hapus Data Simpanan ",d==null?void 0:d.no_ref,"?"]})}),a.jsxs("div",{className:"mt-6 flex justify-end",children:[a.jsx(P,{onClick:()=>p(!1),children:"Batal"}),a.jsx(ja,{className:"ms-3",disabled:w,children:"Hapus"})]})]})})]})}ya.layout=t=>a.jsx(ea,{header:a.jsx(sa,{children:"Data Simpanan"}),children:t,user:t.props.auth.user,organization:t.props.organization,title:"Data Simpanan",backLink:a.jsx(i,{href:route("cashflow.saving",t.props.organization.id),children:a.jsx(la,{})}),breadcrumbs:a.jsx("div",{className:"text-sm breadcrumbs",children:a.jsxs("ul",{children:[a.jsx("li",{className:"font-bold",children:a.jsx(i,{href:route("cashflow",t.props.organization.id),children:"Arus Kas"})}),a.jsx("li",{className:"font-bold",children:a.jsx(i,{href:route("cashflow.saving",t.props.organization.id),children:"Simpanan"})}),a.jsx("li",{children:"Data Simpanan"})]})}),role:t.props.role});export{ya as default};
