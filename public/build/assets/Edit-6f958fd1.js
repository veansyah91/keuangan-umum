import{r as n,W as G,y as X,j as e,Y as Z,a as h}from"./app-71a08f08.js";import{D as M,A as ee}from"./AuthenticatedLayout-d23faefd.js";import{H as se}from"./Header-1bd6e118.js";import{o as N,p as ae,c as te}from"./index.esm-e93d8aec.js";import{S as le}from"./SecondaryButton-c90a4984.js";import{P as re}from"./PrimaryButton-efd14abd.js";import{F as de}from"./FormInput-2483c16b.js";import{k as ie,Q as F}from"./react-toastify.esm-a15464d8.js";import{I as o}from"./InputLabel-7cf8e87d.js";import{T as b}from"./TextInput-d3c17b84.js";import{o as oe,u as ne}from"./usePrevious-05b7ccb4.js";import{N as ce}from"./react-number-format.es-aa6544d3.js";import{C as x}from"./ClientSelectInput-6fe1c614.js";import{d as K}from"./dayjs.min-b64be250.js";import{A as w}from"./disclosure-2a022ab5.js";import{q as me}from"./transition-105fbe16.js";import"./index.esm-02f248dd.js";import"./iconBase-0837d2ad.js";/* empty css                      */import"./combobox-a4302679.js";import"./keyboard-3c0f8685.js";import"./active-element-history-83f33841.js";import"./use-resolve-button-type-9101f3a8.js";function xe({organization:d,newRef:ue,date:pe,cashAccounts:_,projects:f,programs:v,departments:g,cashMutation:a}){const[i,P]=n.useState(a.accountDebit),[E,I]=n.useState(a.accountCredit),[u,y]=n.useState({id:a.journal.project_id,name:a.journal.project_id?a.journal.project.name:"",code:a.journal.project_id?a.journal.project.codes:""}),[p,D]=n.useState({id:a.journal.program_id,name:a.journal.program_id?a.journal.program.name:"",code:a.journal.program_id?a.journal.program.codes:""}),[j,S]=n.useState({id:a.journal.department_id,name:a.journal.department_id?a.journal.department.name:"",code:a.journal.department_id?a.journal.department.codes:""}),[m,T]=n.useState({startDate:a.date,endDate:a.date}),{data:r,setData:t,patch:A,reset:je,errors:c,setError:he,processing:R}=G({date:a.date,no_ref:a.no_ref,description:a.description,program_id:a.program_id,project_id:a.project_id,department_id:a.department_id,is_approved:a.journal.is_approved>0,value:a.value,accountDebit:a.accountDebit.id,accountCredit:a.accountCredit.id}),[B]=oe(m,500),H=ne(m);n.useEffect(()=>{if(H!==void 0){let s=K(m.startDate),l=`${s.month()+1}-${s.year()}`,k=K(a.date),W=`${k.month()+1}-${k.year()}`;l!==W?V():t("no_ref",a.no_ref)}},[B]);const O=s=>{s.preventDefault(),A(route("cashflow.cash-mutation.update",{organization:d.id,cashMutation:a.id}),{onSuccess:l=>{F.success("Mutasi Kas Berhasil Diubah",{position:F.POSITION.TOP_CENTER})},onError:l=>{},preserveScroll:!0})},V=()=>{X.reload({only:["newRef"],data:{date:m.startDate},onSuccess:s=>{t("no_ref",s.props.newRef)}})},C=(s,l)=>{l=="debit"?(P({id:s.id,name:s.name,code:s.code,is_cash:!0}),t("accountDebit",s.id)):(I({id:s.id,name:s.name,code:s.code,is_cash:!0}),t("accountCredit",s.id))},$=s=>{T(s),t("date",s.startDate)},z=s=>{D(s),t("program_id",s.id)},U=()=>{D({id:null,name:"",code:""}),t("program_id",null)},Y=s=>{y(s),t("project_id",s.id)},L=()=>{y({id:null,name:"",code:""}),t("project_id",null)},q=s=>{S(s),t("department_id",s.id)},J=()=>{S({id:null,name:"",code:""}),t("department_id",null)},Q=s=>{const{floatValue:l}=s;t("value",l)};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:"Ubah Mutasi Kas"}),e.jsx(ie,{}),e.jsx(de,{onSubmit:O,children:e.jsx("div",{className:"w-full sm:mt-2 sm:py-5",children:e.jsxs("div",{className:"sm:mx-auto px-3 sm:px-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"Tanggal"})}),e.jsx("div",{children:e.jsx(M,{value:m,onChange:$,inputClassName:(c==null?void 0:c.date)&&"border-red-500 rounded-lg",useRange:!1,asSingle:!0,placeholder:"Tanggal",id:"date",displayFormat:"MMMM DD, YYYY"})})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"No. Ref",htmlFor:"no_ref"})}),e.jsx("div",{children:e.jsx(b,{id:"no_ref",className:`w-full ${c.no_ref&&"border-red-500"}`,value:r.no_ref,onChange:s=>t("no_ref",s.target.value)})})]}),e.jsxs("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"Deskripsi",htmlFor:"description"})}),e.jsx("div",{children:e.jsx(b,{id:"description",className:"w-full",value:r.description,onChange:s=>t("description",s.target.value)})})]})]}),(f.length>0||v.length>0||g.length>0)&&e.jsx("div",{className:"mt-3",children:e.jsx(w,{children:({open:s})=>e.jsxs(e.Fragment,{children:[e.jsx(me,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsx(w.Panel,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:[v.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"Program Kegiatan",htmlFor:"program"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(x,{resources:v,selected:p,setSelected:l=>z(l),maxHeight:"max-h-40",placeholder:"Cari Program Kegiatan",id:"program",isError:!1}),p.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",p.code]})]}),p.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:U,children:e.jsx(N,{})})})]})]}),f.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"Proyek",htmlFor:"project"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(x,{resources:f,selected:u,setSelected:l=>Y(l),maxHeight:"max-h-40",placeholder:"Cari Proyek",id:"project",isError:!1}),u.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",u.code]})]}),u.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:L,children:e.jsx(N,{})})})]})]}),g.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"Departemen",htmlFor:"department"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(x,{resources:g,selected:j,setSelected:l=>q(l),maxHeight:"max-h-40",placeholder:"Cari Departemen",id:"department",isError:!1}),j.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",j.code]})]}),j.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:J,children:e.jsx(N,{})})})]})]})]})})}),e.jsx(w.Button,{className:"flex w-full justify-between rounded-lg bg-slate-100 px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-slate-500/75",children:e.jsxs("div",{className:"flex justify-center w-full gap-3",children:[e.jsxs("span",{children:["Tampilkan Lebih ",s?"Sedikit":"Banyak"]}),e.jsx(ae,{className:`${s?"":"rotate-180 transform"} h-5 w-5 text-slate-500`})]})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 mt-7",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"Dari Akun Kas",htmlFor:"credit_account"})}),e.jsxs("div",{children:[e.jsx(x,{resources:_,selected:E,setSelected:s=>C(s,"credit"),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!c.accountCredit,id:"credit_account"}),(i==null?void 0:i.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",i.code]})]})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"Ke Akun Kas",htmlFor:"debit_account"})}),e.jsxs("div",{children:[e.jsx(x,{resources:_,selected:i,setSelected:s=>C(s,"debit"),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!c.accountCredit,id:"debit_account"}),(i==null?void 0:i.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",i.code]})]})]}),e.jsxs("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(o,{value:"Jumlah",htmlFor:"value"})}),e.jsx("div",{children:e.jsx(ce,{value:r.value,customInput:b,onValueChange:s=>Q(s),thousandSeparator:!0,className:"text-end w-full",prefix:"IDR ",id:"value"})})]})]}),e.jsxs("div",{className:"md:flex font-bold gap-3",children:[e.jsx("div",{className:"sm:w-6/12 hidden sm:block"}),e.jsx("div",{className:"md:w-6/12 flex border-t py-3 gap-2 px-3",children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer gap-2",htmlFor:"checkbox",children:[e.jsx("input",{type:"checkbox",className:"checkbox",id:"checkbox",value:!r.is_approved,onChange:()=>t("is_approved",!r.is_approved),checked:!r.is_approved}),e.jsx("span",{className:"label-text",children:"Simpan Ke Dalam Draft"})]})})})]}),e.jsxs("div",{className:"flex justify-end flex-col-reverse sm:flex-row gap-2 mt-5",children:[e.jsx("div",{className:"w-full sm:w-1/12 my-auto text-center",children:e.jsx(h,{href:route("cashflow.cash-mutation",d.id),children:e.jsx(le,{className:"w-full",children:e.jsx("div",{className:"text-center w-full",children:"Batal"})})})}),r.value>0&&r.accountDebit&&r.accountCredit&&r.date&&r.no_ref&&e.jsx("div",{className:"w-full sm:w-1/12 text-center",children:e.jsx(re,{className:"w-full",disabled:R,children:e.jsx("div",{className:"text-center w-full",children:"Tambah"})})})]})]})})})]})}xe.layout=d=>e.jsx(ee,{header:e.jsx(se,{children:"Ubah Mutasi Kas"}),children:d,user:d.props.auth.user,organization:d.props.organization,title:"Ubah Mutasi Kas",backLink:e.jsx(h,{href:route("cashflow.cash-mutation",d.props.organization.id),children:e.jsx(te,{})}),breadcrumbs:e.jsx("div",{className:"text-sm breadcrumbs",children:e.jsxs("ul",{children:[e.jsx("li",{className:"font-bold",children:e.jsx(h,{href:route("cashflow",d.props.organization.id),children:"Arus Kas"})}),e.jsx("li",{className:"font-bold",children:e.jsx(h,{href:route("cashflow.cash-mutation",d.props.organization.id),children:"Mutasi Kas"})}),e.jsx("li",{children:"Ubah Mutasi Kas"})]})}),role:d.props.role});export{xe as default};
