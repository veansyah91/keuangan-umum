import{r as c,W as U,y as W,j as e,Y as G,a as p}from"./app-61e58707.js";import{D as X,A as Z}from"./AuthenticatedLayout-4d39d6f2.js";import{H as ee}from"./Header-7b25195a.js";import{o as y,p as se,c as ae}from"./index.esm-f345f17b.js";import{S as te}from"./SecondaryButton-d3c9d62c.js";import{P as le}from"./PrimaryButton-9b232afd.js";import{F as re}from"./FormInput-e4c391cc.js";import{k as ie,Q as F}from"./react-toastify.esm-6b3c944a.js";import{I as d}from"./InputLabel-ab29f6f7.js";import{T as _}from"./TextInput-aa487edd.js";import{o as de,u as ce}from"./usePrevious-6c25aa69.js";import{N as ne}from"./react-number-format.es-f4f4ff6f.js";import{C as o}from"./ClientSelectInput-afd05020.js";import{A as S}from"./disclosure-b2f48524.js";import{q as oe}from"./transition-95d25f91.js";import"./index.esm-a7ecb966.js";import"./iconBase-ea2c5aa0.js";/* empty css                      */import"./dayjs.min-493e051a.js";import"./combobox-8451aef3.js";import"./keyboard-6bdeaeaf.js";import"./active-element-history-5b666695.js";import"./use-resolve-button-type-9636a1f1.js";function me({organization:r,newRef:T,date:j,cashAccounts:D,projects:f,programs:v,departments:N}){const[i,C]=c.useState({id:null,name:"",code:"",is_cash:!0}),[E,k]=c.useState({id:null,name:"",code:"",is_cash:!0}),[m,b]=c.useState({id:null,name:"",code:""}),[u,w]=c.useState({id:null,name:"",code:""}),[x,g]=c.useState({id:null,name:"",code:""}),[h,K]=c.useState({startDate:j,endDate:j}),{data:l,setData:t,post:I,reset:ue,errors:n,setError:xe,processing:M}=U({date:j,no_ref:T,description:"Mutasi Kas",program_id:null,project_id:null,department_id:null,is_approved:!0,value:0,accountDebit:null,accountCredit:null}),[A]=de(h,500),R=ce(h);c.useEffect(()=>{R!==void 0&&O()},[A]);const B=s=>{s.preventDefault(),I(route("cashflow.cash-mutation.post",r.id),{onSuccess:a=>{H(a.props),F.success("Mutasi Kas Berhasil Ditambahkan",{position:F.POSITION.TOP_CENTER})},onError:a=>{},preserveScroll:!0})},H=({newRef:s,date:a})=>{t({date:a,no_ref:s,description:"Mutasi Kas",program_id:null,project_id:null,department_id:null,is_approved:!0,value:0,accountDebit:null,accountCredit:null}),K({startDate:a,endDate:a}),C({id:null,name:"",code:"",is_cash:!0}),k({id:null,name:"",code:"",is_cash:!0}),b({id:null,name:"",code:""}),w({id:null,name:"",code:""}),g({id:null,name:"",code:""})},O=()=>{W.reload({only:["newRef"],data:{date:h.startDate},onSuccess:s=>{t("no_ref",s.props.newRef)}})},P=(s,a)=>{a=="debit"?(C({id:s.id,name:s.name,code:s.code,is_cash:!0}),t("accountDebit",s.id)):(k({id:s.id,name:s.name,code:s.code,is_cash:!0}),t("accountCredit",s.id))},V=s=>{K(s),t("date",s.startDate)},Y=s=>{w(s),t("program_id",s.id)},z=()=>{w({id:null,name:"",code:""}),t("program_id",null)},L=s=>{b(s),t("project_id",s.id)},q=()=>{b({id:null,name:"",code:""}),t("project_id",null)},$=s=>{g(s),t("department_id",s.id)},J=()=>{g({id:null,name:"",code:""}),t("department_id",null)},Q=s=>{const{floatValue:a}=s;t("value",a)};return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Tambah Mutasi Kas"}),e.jsx(ie,{}),e.jsx(re,{onSubmit:B,children:e.jsx("div",{className:"w-full sm:mt-2 sm:py-5",children:e.jsxs("div",{className:"sm:mx-auto px-3 sm:px-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Tanggal"})}),e.jsx("div",{children:e.jsx(X,{value:h,onChange:V,inputClassName:(n==null?void 0:n.date)&&"border-red-500 rounded-lg",useRange:!1,asSingle:!0,placeholder:"Tanggal",id:"date",displayFormat:"MMMM DD, YYYY"})})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"No. Ref",htmlFor:"no_ref"})}),e.jsx("div",{children:e.jsx(_,{id:"no_ref",className:`w-full ${n.no_ref&&"border-red-500"}`,value:l.no_ref,onChange:s=>t("no_ref",s.target.value)})})]}),e.jsxs("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Deskripsi",htmlFor:"description"})}),e.jsx("div",{children:e.jsx(_,{id:"description",className:"w-full",value:l.description,onChange:s=>t("description",s.target.value)})})]})]}),(f.length>0||v.length>0||N.length>0)&&e.jsx("div",{className:"mt-3",children:e.jsx(S,{children:({open:s})=>e.jsxs(e.Fragment,{children:[e.jsx(oe,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsx(S.Panel,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-start gap-3 sm:py-5 mb-3",children:[v.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Program Kegiatan",htmlFor:"program"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(o,{resources:v,selected:u,setSelected:a=>Y(a),maxHeight:"max-h-40",placeholder:"Cari Program Kegiatan",id:"program",isError:!1}),u.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",u.code]})]}),u.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:z,children:e.jsx(y,{})})})]})]}),f.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Proyek",htmlFor:"project"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(o,{resources:f,selected:m,setSelected:a=>L(a),maxHeight:"max-h-40",placeholder:"Cari Proyek",id:"project",isError:!1}),m.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",m.code]})]}),m.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:q,children:e.jsx(y,{})})})]})]}),N.length>0&&e.jsxs("div",{className:"sm:w-1/3 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Departemen",htmlFor:"department"})}),e.jsxs("div",{className:"flex w-full relative",children:[e.jsxs("div",{className:"w-5/6",children:[e.jsx(o,{resources:N,selected:x,setSelected:a=>$(a),maxHeight:"max-h-40",placeholder:"Cari Departemen",id:"department",isError:!1}),x.id&&e.jsxs("span",{className:"text-xs absolute",children:["Kode: ",x.code]})]}),x.id&&e.jsx("div",{className:"w-1/6 my-auto",children:e.jsx("button",{type:"button",className:"text-red-500 text-xl hover:bg-slate-200 rounded-full p-2",onClick:J,children:e.jsx(y,{})})})]})]})]})})}),e.jsx(S.Button,{className:"flex w-full justify-between rounded-lg bg-slate-100 px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200 focus:outline-none focus-visible:ring focus-visible:ring-slate-500/75",children:e.jsxs("div",{className:"flex justify-center w-full gap-3",children:[e.jsxs("span",{children:["Tampilkan Lebih ",s?"Sedikit":"Banyak"]}),e.jsx(se,{className:`${s?"":"rotate-180 transform"} h-5 w-5 text-slate-500`})]})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 mt-7",children:[e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Dari Akun Kas",htmlFor:"credit_account"})}),e.jsxs("div",{children:[e.jsx(o,{resources:D,selected:E,setSelected:s=>P(s,"credit"),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!n.accountCredit,id:"credit_account"}),(i==null?void 0:i.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",i.code]})]})]}),e.jsxs("div",{className:"sm:w-1/4 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Ke Akun Kas",htmlFor:"debit_account"})}),e.jsxs("div",{children:[e.jsx(o,{resources:D,selected:i,setSelected:s=>P(s,"debit"),maxHeight:"max-h-40",placeholder:"Cari Akun",isError:!!n.accountCredit,id:"debit_account"}),(i==null?void 0:i.code)&&e.jsxs("div",{className:"absolute text-xs",children:["Kode: ",i.code]})]})]}),e.jsxs("div",{className:"sm:w-1/2 w-full text-slate-900 space-y-2",children:[e.jsx("div",{children:e.jsx(d,{value:"Jumlah",htmlFor:"value"})}),e.jsx("div",{children:e.jsx(ne,{value:l.value,customInput:_,onValueChange:s=>Q(s),thousandSeparator:!0,className:"text-end w-full",prefix:"IDR ",id:"value"})})]})]}),e.jsxs("div",{className:"md:flex font-bold gap-3",children:[e.jsx("div",{className:"sm:w-6/12 hidden sm:block"}),e.jsx("div",{className:"md:w-6/12 flex border-t py-3 gap-2 px-3",children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer gap-2",htmlFor:"checkbox",children:[e.jsx("input",{type:"checkbox",className:"checkbox",id:"checkbox",value:!l.is_approved,onChange:()=>t("is_approved",!l.is_approved),checked:!l.is_approved}),e.jsx("span",{className:"label-text",children:"Simpan Ke Dalam Draft"})]})})})]}),e.jsxs("div",{className:"flex justify-end flex-col-reverse sm:flex-row gap-2 mt-5",children:[e.jsx("div",{className:"w-full sm:w-1/12 my-auto text-center",children:e.jsx(p,{href:route("data-ledger.journal",r.id),children:e.jsx(te,{className:"w-full",children:e.jsx("div",{className:"text-center w-full",children:"Batal"})})})}),l.value>0&&l.accountDebit&&l.accountCredit&&l.date&&l.no_ref&&e.jsx("div",{className:"w-full sm:w-1/12 text-center",children:e.jsx(le,{className:"w-full",disabled:M,children:e.jsx("div",{className:"text-center w-full",children:"Tambah"})})})]})]})})})]})}me.layout=r=>e.jsx(Z,{header:e.jsx(ee,{children:"Tambah Mutasi Kas"}),children:r,user:r.props.auth.user,organization:r.props.organization,title:"Tambah Mutasi Kas",backLink:e.jsx(p,{href:route("cashflow.cash-mutation",r.props.organization.id),children:e.jsx(ae,{})}),breadcrumbs:e.jsx("div",{className:"text-sm breadcrumbs",children:e.jsxs("ul",{children:[e.jsx("li",{className:"font-bold",children:e.jsx(p,{href:route("cashflow",r.props.organization.id),children:"Arus Kas"})}),e.jsx("li",{className:"font-bold",children:e.jsx(p,{href:route("cashflow.cash-mutation",r.props.organization.id),children:"Mutasi Kas"})}),e.jsx("li",{children:"Tambah Mutasi Kas"})]})}),role:r.props.role});export{me as default};
